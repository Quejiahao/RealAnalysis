% !Mode:: "TeX:UTF-8"
%-------------------- 文类 --------------------
\documentclass[UTF8, a4paper, 12pt, twoside, onecolumn]{book}

%-------------------- 包 --------------------
\input{../template/usepackage}

%-------------------- 杂 --------------------
\newcommand\blfootnote[1]{\begingroup\renewcommand\thefootnote{}\footnote{#1}\addtocounter{footnote}{-1}\endgroup}
\newcommand{\upcite}[1]{\textsuperscript{\textsuperscript{\cite{#1}}}}

\geometry{left=2cm, right=2cm, top=2cm, bottom=2cm, headheight=40pt}	% 页边距
%\renewcommand{\baselinestretch}{1.5}	% 行距, 系统默认约 1.2, ctex 默认约 1.56
%\linespread{1}	% 行距

\setcounter{MaxMatrixCols}{20}	% 矩阵最大列数

\makeatletter
\renewcommand*\env@matrix[1][\arraystretch]{%
	\edef\arraystretch{#1}%
	\hskip -\arraycolsep
	\let\@ifnextchar\new@ifnextchar
	\array{*\c@MaxMatrixCols c}}
\makeatother	% 矩阵行距

\newcommand{\watermark}[3]{\AddToShipoutPictureBG{
\parbox[b][\paperheight]{\paperwidth}{
\vfill%
\centering%
\tikz[remember picture, overlay]%
  \node [rotate = #1, scale = #2] at (current page.center)%
    {\textcolor{gray!80!cyan!30}{#3}};
\vfill}}}
\newcommand{\watermarkoff}{\ClearShipoutPictureBG}

\xeCJKsetup{CJKecglue={}}

\raggedbottom	% 防止报 Underfull \vbox (badness 10000) has occurred while \output is active []

%-------------------- 文档自定义 --------------------



%-------------------- 标题 --------------------
\input{title}

%-------------------- 字体设置 --------------------
\input{../template/fonts}
\setCJKfamilyfont{FZQTJW}{方正启体简体.TTF}
\newcommand{\qiti}{\CJKfamily{FZQTJW}}

%-------------------- 自定义符号 --------------------
\input{../template/symbols}

%-------------------- 自定义环境 --------------------
\input{environments}

%-------------------- \item 编号 --------------------
\input{../template/itemstyle}

%-------------------- 页眉页脚 --------------------
\input{headersfooters}

%-------------------- 正文 --------------------
\begin{document}
%\watermark{60}{5}{最后编译时间: \number\year ~年 \number\month ~月 \number\day ~日 \currenttime}	% 水印
%\watermark{60}{7}{\kaishu 数\quad 学\quad 软\quad 件\quad 作\quad 业}	% 水印
%\columnseprule = 1pt	% 栏线
\zihao{5}

\thispagestyle{plain}

\renewcommand{\thepage}{C\arabic{page}}

\maketitle

\frontmatter	% 罗马数字页码
\chapter*{前言}
% \addcontentsline{toc}{chapter}{前言}

本笔记以刘永平老师的实变函数课板书记录, 修改而成. 使用的教材是王昆杨老师的《实变函数论讲义》, 笔记中提到的 “书上” 指的是此书. 以前的笔记记在了纸上, 所有 \textcolor{red}{?????} 处都是我没弄懂或者有错误的地方.

\tableofcontents

\mainmatter	% 阿拉伯数字页码

\chapter{用开集刻画可测集}	%\S 3.1.4

\begin{Theorem}\label{thm:OpenMeas}
	设 $E \subset \R^n$. $E$ 可测当且仅当对于任意的 $\varepsilon > 0$, 存在开集 $G \supset E$, 使得 $m^*(G \setminus E) < \varepsilon$.
\end{Theorem}

\begin{Proof}
	必要性.

	设 $E$ 可测. $m(E) < \infty$ 时, 由测度定义 $m(E) = m^*(E)$, 任意的 $\varepsilon > 0$, 存在可数个方块 $Q_k$, 使得
	$$\dbigcup_{k = 1}^\infty Q_k \supset E,\quad \dsum_{k=1}^{\infty} \lv Q_k \rv < m(E) + \varepsilon.$$
	令 $G = \dbigcup_{k= 1}^\infty Q_k$, 则 $G$ 是开集, 满足
	$$G \supset E,\quad m(G) \leq \dsum_{k = 1}^{\infty} \lv Q_k \rv < m(E) + \varepsilon.$$
	又因为 $G = E \cup (G \setminus E)$ 是不交并, 所以由测度的可加性得 $m(G) = m(E) + m(G\setminus E)$, 进而 $m(G\setminus E) = m(G) - m(E) < \varepsilon$.

$m(E) = \infty$ 时, 注意到
	$$\R^n = \dbigcup_{k = 2}^{\infty} \(B(O; k) \setminus B(O; k - 1)\) \cup B(O; 1),$$
设
	$$E_1 = B(O; 1) \cap E,\quad E_k = \(B(O; k) \setminus B(O; k - 1)\) \cap E,\quad k = 2, 3, \cdots,$$
有
	$$E = E \cap \R^n = \dbigcup_{n = 2}^\infty \(\(B(O; k) \setminus B(O; k - 1)\) \cap E\) \cup \(B(O; 1) \cap E\) = \dbigcup_{k = 1}^\infty E_k.$$
$\lb E_k \rb$ 两两不交, 可测且 $m(E_k) < \infty, k \in \N_+$. 由已经证明的 $m(E) < \infty$ 的情况, 对于任意的 $\varepsilon > 0$, 存在开集 $G_k \supset E_k$, 使得 $m(G_k \setminus E_k)< \dfrac{\varepsilon}{2^k}$. 令 $G = \dbigcup_{k = 1}^\infty G_k$, 则 $G$ 是开集, 且 $G \supset \dbigcup_{k = 1}^{\infty} E_k = E$. 又
$$G \setminus E = \(\dbigcup_{k = 1}^\infty G_k\) \setminus \(\dbigcup_{k = 1}^\infty E_k\) =\dbigcup_{k = 1}^\infty\(G_k \cap \(\dbigcup_{k = 1}^\infty E_k\)^c\) \subset \dbigcup_{k = 1}^\infty \(G_k \setminus E_k\),$$
得
$$m(G\setminus E) \leq \dsum_{k = 1}^{\infty} m(G_k\setminus E_k) < \dsum_{k=1}^{\infty}\dfrac{\varepsilon}{2^k} = \varepsilon.$$

充分性.

对于每个 $\varepsilon_k = \dfrac{1}{k}, k\in \N_+$, 存在开集 $G_k \supset E$, 使得 $m^*(G_k \setminus E) < \dfrac{1}{k}$. 令 $H = \dbigcap_{k = 1}^\infty G_k $, 则有
	$$H \setminus E \subset G_k \setminus E,\quad k \in \N_+,$$
进而
$$m^*(H\setminus E) \leq m^*(G_k \setminus E) <\dfrac{1}{k},\quad k\in \N_+,$$
所以 $m^*(H\setminus E) = 0$. 令 $Z = H \setminus E$, 注意到 $E \subset H$, 所以 $E = H \setminus Z$ 是两可测集之差, $E$ 是可测集.
\end{Proof}

\begin{Example}\label{exm:LimCou}
	设 $\lb E_k \rb$ 是一列可测集.
\begin{enumerate}
	\item 若 $E_1 \subset E_2 \subset\cdots \subset E_k \subset \cdots, $ 则 $\dlim_{k\to \infty} m(E_k) = m\(\cu E_k\)$.
	\item 若 $E_1 \supset E_2 \supset\cdots \supset E_k \supset \cdots, $ 且 $m(E_1) < \infty$, 则 $\dlim_{k\to \infty} m(E_k) = m\(\cis E_k\)$.\label{enu:SupsetLim}
\end{enumerate}
\end{Example}

\begin{Proof}
(i) 若 $m(E_k) < \infty, \forall k \in \N_+$. 记
$$B_1 = E_1,\quad B_k = E_k \setminus E_{k - 1},\quad k = 2, 3, \cdots,$$
则有 $\cu E_k = \cu B_k$, $\lb B_k \rb$ 两两不交且可测. 进而
\begin{align*}
	m\(\cu E_k\) &= \csum m(B_k) = \lim_{N \to \infty} \dsum_{k = 1}^N m(B_k)\\
	&= \lim_{N \to \infty} \(m(E_1) + \dsum_{k = 2}^N (m(E_k) - m(E_{k - 1}))\) = \lim_{N \to \infty} m(E_N).
\end{align*}
若存在 $k_0$ 使 $m\(E_{k_0}\) = \infty$, 则由 $\lb E_k \rb$ 单调性可得, 任意 $k \geq k_0$ 都有 $m(E_k) = \infty$, 进而 $\dlim_{k\to \infty} m(E_k) = \infty.$ 又因为 $\cu E_k \supset E_k$, 所以 $m\(\cu E_k\) = \infty$.

(ii) $\lb E_1 \setminus E_k\rb$ 是单增集列, 故 $\dlim_{k \to \infty} m\(E_1 \setminus E_k\) = m\(\cu (E_1 \setminus E_k)\)$. 由 $m(E_1) < \infty$, $E_k \subset E_1$, 所以 $m(E_1 \setminus E_k) = m(E_1) - m(E_k)$. 进而
\begin{align*}
\cu (E_1 \setminus E_k) = E_1 \setminus \cis E_k,\quad m\(\cu \(E_1 \setminus E_k\)\) = m\(E_1\) - m\(\cis E_k\).
\end{align*}
\end{Proof}

\begin{Remark}
例 \ref{exm:LimCou} \eqref{enu:SupsetLim} 去掉条件 $m\(E_{k_1}\) < \infty$ 时, 结论不再成立. 如 $E_k = (k, +\infty), k = 1, 2, \cdots$.
\end{Remark}

\begin{Definition}[内测度]
	设 $m_*(E) = \sup \lb m(F) : F\subset E, F~\text{是闭集} \rb$, 称 $m^*(E)$ 为 $E$ 的内测度. 可以证明 $E$ 可测当且仅当 $m^*(E) = m_*(E)$.
\end{Definition}

\chapter{可测函数}	%\S 3.2

\begin{Definition}[广义实函数]
	$E$ 可测, 记 $\oR = \R \cup \lb -\infty, +\infty \rb$. 称 $f : E \to \overline{\R}$ 为广义实函数.
\end{Definition}

\begin{Proposition}
$$\cu \l[c + \dfrac{1}{k}, +\infty\r] = (c, +\infty],\quad [c, +\infty] = \cis\(c - \dfrac{1}{k}, +\infty\r].$$
\end{Proposition}

\begin{Proposition}
零测集上的函数可测.
\end{Proposition}

\begin{Proof}
	设 $E$ 是零测度及 $f: E \to \overline{\R}$. 对于任意的 $c \in \overline{\R}$, $E(f > c)$ 是零测集, 故 $f$ 是可测的.
\end{Proof}

\begin{Proposition}
设 $E_1 \subset E$, $E_1, E$ 可测, $f$ 在 $E$ 上可测, 则 $f$ 在 $E_1$ 上可测.
\end{Proposition}

\begin{Proof}
	$\forall c \in \R,$ $E_1(f > c) = E_1 \cap \(E(f > c)\)$.
\end{Proof}

\begin{Proposition}
设 $\lb E_k \rb$ 是一个可测集列, $E = \cu E_k$. 若 $f: E \to \overline{\R}$, $f$ 在 $E_k,$ $k = 1, 2, \cdots$ 上可测, 则 $f$ 在 $E$ 上可测.
\end{Proposition}

\begin{Proof}
	$\forall c \in \R,$ $E(f > c) = \cu E_k(f > c)$.
\end{Proof}

\begin{Proposition}\label{pro:ContMear}
设 $E$ 可测, 若 $f: E \to \oR$ 连续, 则 $f$ 是可测函数.
\end{Proposition}

\begin{Proof}
	由可测集的结构, 存在闭集列 $\lb F_k \rb$ 及一个零测集 $E_0$, 使得 $E = \cu F_k \cup E_0$. 若 $f$ 在 $E$ 上连续, 则 $f$ 在 $F_k$ 上是连续的.

	下面证明: 任意 $c \in \R, F_k(f \geq c)$ 是闭集. 由极限点的定义可得
	$$\forall y\in (F_k(f \geq c))',\quad \exists y_l \in F_k(f \geq c),\quad l = 1, 2, \cdots,\quad \text{使得}~y_l \to y,\quad l \to \infty.$$
由 $y_l, l \in \N_+$ 的取法, $f(y_l) \geq c, l \in \N_+$. 因为 $F_k$ 是闭集, 所以 $y \in F_k$. 注意到 $f$ 的连续性, 有 $f(y) \geq c$, 故 $y \in F_k(f \geq c)$.

综上所述, $E(f \geq c) = \cu F_k(f \geq c) \cup E_0(f\geq c)$ 可测, 进而 $f$ 是可测函数.
\end{Proof}

\begin{Proposition}
可测集的特征函数是可测的.
\end{Proposition}

\begin{Proof}
	$\forall c \in \R$, $\lb x \in \R^n : \chi_E(x) > c\rb = \lb \begin{array}{ll}
		\varnothing, & c \geq 1, \\
		E, & 0 < c \leq 1, \\
		\R^n, & c < 0.
	\end{array} \right.$
\end{Proof}

\begin{Theorem}
	设 $f, g$ 在 $E$ 上可测, 不会同时取无穷值. 若 $\a, \beta \in \R$, 则 $\a f + \beta g$ 可测, 且 $fg$ 可测.
\end{Theorem}

\begin{Proof}
	先证 $f + g$ 可测.

	$E(f = +\infty)$, $E(g = +\infty)$ 可测. 事实上,
	$$E(f = +\infty) = \cis E(f > k),\quad E(g = +\infty) = \cis E(g > k)$$
	可测. 记 $E_1 = E \setminus \(E(f = +\infty)\cup E(g = +\infty)\)$. 对于任意的 $c \in \R$, 都有
	$$E(f + g > c)  = E_1(f + g > c) \cup \(E(f = +\infty) \cup E(g = +\infty)\).$$

	设 $\Q = \lb r_k \rb$, 下面证明
	\begin{equation}\label{equ:fPlusg}
		\cu \lb x \in E_1 : f(x) > r_k > c - g(x)\rb = E_1(f + g > x).
	\end{equation}

	任意的 $x \in E_1(f + g > c)$ 都有 $f(x) + g(x) > c$, $f(x) > c - g(x)$. 存在 $k$ 使得
	$f(x) > r_k > c - g(x)$ 于是 $x \in \lb x \in E_1 : f(x) > r_k > c - g(x) \rb$, 进而
	$$\cu \lb x \in E_1 : f(x) > r_k > c - g(x)\rb \supset E_1(f + g > x).$$

	另一方面, 对于任意的 $k \in \N_+$, 都有
	$$\lb x \in E_1 : f(x) > r_k > c - g(x) \rb \subset \lb x \in E_1 : f(x) > c - g(x) \rb = E_1(f + g > c).$$
	于是证得 \eqref{equ:fPlusg} 式.

	由 $E_1$ 的可测性, 有
	$$E_1(f + g > c) = \cu E_1(f > r_k > c - g)  = \cu (E_1(f > r_k) \cap E_1(g > c - r_k)),$$
	故 $E_1(f + g > c)$ 可测, 进而 $E(f + g > c)$ 可测.

	再证任意 $\alpha \in \R$, $\alpha f$ 可测. 事实上
	$$E(\alpha f > c) = \lb \begin{array}{ll}
		E\(f > \dfrac{c}{\alpha}\), & \alpha > 0, \\
		E\(f < \dfrac{c}{\alpha}\), & \alpha <0, \\
		E, & \alpha = 0, c < 0, \\
		\varnothing, & \alpha = 0, c \geq 0.
	\end{array}\right.$$

	下面给出证明 $fg$ 可测的提示.

	$f = g$ 时, $E(fg > c) = E(f^2 > c) = \lb \begin{aligned}
		& E(f > \sqrt{c}) \cup E(f < - \sqrt{c}), & c > 0, \\
		& E, & c<0.
	\end{aligned}\right.$

	$f \neq g$ 时, $fg = \dfrac{(f + g)^2 - (f - g)^2}{4}$.
\end{Proof}

\begin{Theorem}
	设 $E$ 是可测集, $f_k, k \in \N_+$ 在 $E$ 上可测, 则
	$$\limsup_{k \to \infty} f_k,\quad \liminf_{k \to \infty} f_k$$
	在 $E$ 上可测.
\end{Theorem}

\begin{Proof}
	注意到 $\displaystyle\limsup_{k \to \infty} f_k(x) = \displaystyle\inf_k \displaystyle\sup_{j \geq k} f_j(x)$, 由书上 49 页定理 2.3 前两式可得 $\dsup_{j \geq k} f_j(x), k\in \N_+$ 可测, 进而 $\displaystyle\inf_k \displaystyle\sup_{j \geq k} f_j(x)$ 可测, 即 $\displaystyle\limsup_{k \to \infty} f_k$ 可测, $\displaystyle\liminf_{k \to \infty} f_k$ 的情形同理.
\end{Proof}

\begin{Corollary}
	若 $E$ 上的可测函数列 $\lb f_k \rb$ 满足
	$$f(x) = \displaystyle\limsup_{k \to \infty} f_k(x) = \displaystyle\liminf_{k \to \infty} f_k(x),$$
	则 $f(x)$ 在 $E$ 上可测.
\end{Corollary}

\begin{Theorem}
	设 $f$ 定义在可测集 $E$ 上, 定义
	$$f^+(x) = \max(f(x), 0),\quad f^-(x) = \max(-f(x), 0),$$
	分别称之为 $f$ 的正部和负部函数. 显然有
	$$\lv f(x) \rv = f^+(x) + f^-(x),\quad f(x) = f^+(x) - f^-(x).$$
	若 $f$ 在 $E$ 上可测, 则 $f^+(x), f^-(x)$ 在 $E$ 上可测.
\end{Theorem}

\begin{Example}
	设 $E_1, \cdots, E_m \subset \R^n$ 可测, $\varphi(x)= \dsum_{j = 1}^{m} c_i \chi_{E_j}$ 是一个简单函数.
\end{Example}

\begin{Proposition}
	可测集 $E$ 上任意两个简单函数的和, 差, 积是简单函数.
\end{Proposition}

\begin{Example}
	设
	\begin{align*}
		\varphi &= 2\chi_{(0, 1]} + 4 \chi_{[0, 3]} - 5 \chi_{(-1, 2]}, \\
		\psi &= \chi_{(0, 2]} + 2\chi_{[1, 3]} - \chi_{(-1, 1)},
	\end{align*}
	求 $\varphi + \psi$.

\begin{Solve}
	记
	$$E = (-1, 0) \cup \lb 0 \rb \cup (0, 1) \cup \lb 1 \rb \cup (1, 2] \cup (2, 3],$$
	则有
	\begin{align*}
		\varphi + \psi = -6 \chi_{(-1, 0)} - 2\chi_{\lb 0 \rb} + \chi_{(0, 1)} + 4 \chi_{\lb 1 \rb} + 2 \chi_{(1, 2]} + 6\chi_{(2, 3]}.
	\end{align*}
\end{Solve}
\end{Example}

可用归纳法证明: 设 $\varphi$ 是 $E$ 上一个简单函数, 其中 $E = \dbigcup_{j = 1}^m E_j$, $E_1, E_2, \cdots, E_m$, 两两不交, 则有 $\varphi(x) = \dsum_{j = 1}^{m} \alpha_j \chi_{E_j}(x)$. 提示: $m = 2$ 时,
$$\varphi(x) = c_1\chi_{E_1}(x) + c_2\chi_{E_2}(x) = c_1\chi_{E_1\setminus E_2} + c_2\chi_{E_2 \setminus E_1} + (c_1 + c_2) \chi_{E_1 \cap E_2}(x).$$

\begin{Theorem}\label{thm:fNotNegative}
	设 $E$ 可测, $f$ 在 $E$ 上可测, 并且 $f \geq 0$. 那么, 存在非负简单函数 $\p_k$, $k \in \N_+$, 使得
	$$\forall k \in \N_+,\quad 0 \leq \p_k \leq \p_{k + 1},\quad \forall x \in E,\quad \lim_{k \to \infty} \p_k = f(x).$$
\end{Theorem}

\begin{Proof}
	设 $f$ 在可测集上, 非负可测. 对每个 $m \in \N_+$, 都有
	$$E = \dbigcup_{i = 1}^{m2^m} E\(\dfrac{i - 1}{2^m} \leq f < \dfrac{i}{2^m}\) \cup E(f \geq m),$$
	定义
	$$\varphi_m(x) = \dsum_{i = 1}^{m2^m} \dfrac{i - 1}{2^m} \chi_{E\(\frac{i - 1}{2^m} \leq f < \frac{i}{2^m}\)} (x) + m\chi_{E(f \geq m)}(x).$$

	下证 $\varphi_m(x) \leq \varphi_{m + 1}(x)$, $\forall x \in E$. 注意到
	\begin{align*}
		\varphi_{m + 1} =& \dsum_{i = 1}^{(m + 1)2^{m + 1}} \frac{i - 1}{2^{m + 1}} \chi_{E\(\frac{i - 1}{2^{m + 1}} \leq f < \frac{i}{2^{m + 1}}\)} + (m + 1)\chi_{E(f \geq m + 1)}(x),\\
		E(f \geq m) =& E(f \geq m + 1) \cup E\(\dfrac{m2^{m + 1}}{2^{m + 1}} \leq f < \dfrac{m2^{m + 1} + 1}{2^{m + 1}}\) \\
		&\cup \cdots \cup E\(\dfrac{(m + 1)2^{m + 1} - 1}{2^{m + 1}} \leq f < \dfrac{(m + 1)2^{m + 1}}{2^{m + 1}}\).
	\end{align*}
	$x \in E(f \geq m)$ 时, $\varphi_m(x) = m$. 若 $x \in E(f \geq m + 1)$, 则有
	$$\varphi_{m + 1}(x) = m + 1 \geq m = \varphi_m(x).$$
	若
	$$x \in E\(\dfrac{m2^{m + 1} + j}{2^{m + 1}} \leq f < \dfrac{m2^{m + 1} + j + 1}{2^{m + 1}}\),\quad j = 0, 1, 2, \cdots, 2^{m + 1} - 1,$$
	则有
	$$\varphi_m(x) = m \leq \dfrac{m2^{m + 1} + j}{2^{m + 1}} = \varphi_{m + 1}(x).$$
	$x \in E\(\dfrac{i - 1}{2^m} \leq f < \dfrac{i}{2^m}\)$, $i = 1, \cdots, m2^m$ 时, $\varphi_m(x) = \dfrac{i - 1}{2^m}$. 注意到
	$$E\(\dfrac{i - 1}{2^m} \leq f < \dfrac{i}{2^m}\) = E\(\dfrac{2(i - 1)}{2^{m + 1}} \leq f < \dfrac{2i - 1}{2^{m + 1}}\) \cup E\(\dfrac{2i - 1}{2^{m + 1}} \leq f < \dfrac{2i}{2^{m + 1}}\),$$
	有
	$$\varphi_m(x) = \dfrac{i - 1}{2^m} \leq \varphi_{m + 1}(x) = \lb \begin{array}{ll}
		\dfrac{2(i - 1)}{2^{m + 1}}, & x \in E\(\dfrac{2(i - 1)}{2^{m + 1}} \leq f < \dfrac{2i - 1}{2^{m + 1}}\), \\
		\dfrac{2i - 1}{2^{m + 1}}, & x \in E\(\dfrac{2i - 1}{2^{m + 1}} \leq f < \dfrac{2i}{2^{m + 1}}\).
	\end{array}\right.$$

	下证 $\dlim_{m \to \infty} \varphi_m(x) = f(x)$, $\forall x \in E$. 若 $f(x) = +\infty$, 则 $x \in E(f \geq m)$, $\forall m \in \N_+$, 进而
	$$\dlim_{m \to \infty}\varphi_m(x) = +\infty = f(x).$$
	若 $f(x)$ 有限, 存在 $N \in \N_+$, 使得 $0 \leq f(x) < N$. $m > N$ 时, 存在 $i \in \lb 1, 2, \cdots, m2^m \rb$, 使得
	$$x \in E\(\dfrac{i - 1}{2^m} \leq f < \dfrac{i}{2^m}\).$$
	此时,
	$$\varphi_m(x) = \dfrac{i - 1}{2^m} \leq f(x) < \dfrac{i}{2^m},\quad 0 \leq f(x) - \varphi_m(x) < \dfrac{1}{2^m},\quad m > N.$$
	因此 $\dlim_{m \to \infty} \varphi(x) = f(x)$.
\end{Proof}

\begin{Corollary}
	设 $E$ 可测, $f$ 在 $E$ 上可测, 则存在两个简单函数列 $\lb \varphi_k \rb,~\lb \psi_k \rb$, 满足
	\begin{align*}
	0 \leq \varphi_1 \leq \varphi_2 \leq \cdots,~0 \leq \psi_1 \leq \psi_2 \leq \cdots,\quad \varphi_k(x) \psi_k(x) = 0,~x \in E,\quad \lim_{k \to \infty} \(\varphi_k(x) - \psi_k(x)\) = f(x).
	\end{align*}
\end{Corollary}

\begin{Proof}
	设 $f = f^+ - f^-$, 则 $f^+(x)f^-(x) = 0$. 由定理 \ref{thm:fNotNegative}, 存在两个非负简单函数列 $\lb \varphi_k \rb,~\lb \psi_k \rb$, 满足
$$0 \leq \varphi_k \nearrow f^+ (k \to \infty),\quad 0 \leq \psi_k \nearrow f^- (k \to \infty).$$
	若 $f^+(x) > 0$,
	$$\left.\begin{matrix}
		\varphi_k(x) \to f^+(x) \\
		\psi_k(x) = 0
	\end{matrix}\rb \Rightarrow \varphi_k(x) - \psi_k(x) \to f^+(x) = f(x).$$
	若 $f^-(x) > 0$,
	\begin{align*}
		\left.\begin{matrix}
		\varphi_k(x) = 0 \\
		\psi_k(x) \to f^-(x)
	\end{matrix}\rb \Rightarrow \varphi_k(x) - \psi_k(x) \to -f^-(x) = f(x).
	\end{align*}
\end{Proof}

\chapter{可测函数的结构}	%\S 3.2.2

\section{紧集上连续函数的延拓}

\begin{Definition}[几乎处处连续]
	若函数不连续点的集合是零测集, 则称这样的函数为几乎处处连续函数.
\end{Definition}

\begin{Definition}[几乎处处收敛]
	$\lb f_k \rb$ 是 $E$ 上的一个函数列. 若 $\lb f_k \rb$ 不收敛的点集是零测集, 则称 $\lb f_k \rb$ 在 $E$ 上几乎处处收敛.
\end{Definition}

\begin{Definition}[几乎处处有限]
	$E(|f| = \infty)$ 是零测集.
\end{Definition}

\begin{Definition}[本性有界]
	若存在 $M > 0$, 使 $E(|f| > M)$ 是零测集, 即 $x \in E$ 上几乎处处成立 $|f(x)| \leq M$.
\end{Definition}

\begin{Definition}[延拓]
	设 $f : E \to \R$, 若存在 $G \supset E$ 及 $F : G \to \R$, 使得 $F|_E = f$, 则称 $F$ 是 $f$ 从 $E$ 到 $G$ 的一个延拓.
\end{Definition}

\begin{Lemma}
	设 $K$ 为 $\R^n$ 的非空紧子集, $F$ 是 $\R^n$ 的非空闭子集. 若 $K \cap F = \varnothing$, 则存在 $f \in C(\R^n)$ 满足 $\chi_K \leq f \leq \chi_{F^c}$.
\end{Lemma}

\begin{Proof}
	先考虑一个事实: 若 $A \subset \R^n$ 不空, 定义
	$$d(x, A) = \inf \lb |x - y| : y \in A \rb,$$
	称之为点 $x$ 到 $A$ 之间的距离. $d(x, A)$ 满足
	$$\lv d(x', A) - d(x'', A) \rv \leq \lv x' - x'' \rv,\quad \forall x', x'' \in \R^n,$$
	并且距离函数连续. 设
	$$f(x) = \dfrac{d(x, F)}{d(x, K) + d(x, F)},$$
	则 $f$ 在 $\R^n$ 上是良定义的 (\textcolor{red}{?????书上习题 2.2 12 (3)}), 并且满足 $f(x) = 1, x \in K, f(x) = 0, x \in F$.
\end{Proof}

\begin{Corollary}\label{cor:KFab}
	设 $K$ 为 $\R^n$ 的非空紧子集, $F$ 为 $\R^n$ 的非空闭子集, $a, b \in \R^n$. 若 $K \cap F = \varnothing$, 则存在 $f \in C(\R^n)$ 取值于 $a, b$ 之间, 并且满足
	$$\forall x \in K, f(x) = a,\quad \forall x \in F, f(x) = b.$$
\end{Corollary}

\begin{Proof}
	\begin{align*}
		\p (x) = \dfrac{d(x, F)}{d(x, K) + d(x, F)}, \quad \psi (x) = \dfrac{d(x, K)}{d(x, K) + d(x, F)},\quad f(x) = a\p(x) + b\psi(x).
	\end{align*}
\end{Proof}

\begin{Theorem}[延拓定理]\label{thm:Extend}
	设 $K$ 为 $\R^n$ 的非空紧子集, $f \in C(K)$. 那么, 存在 $g \in C(\R^n)$, 使得
	$$\|g\|_{C(\R^n)} \leq \|f\|_{C(K)},\quad \forall x \in K,\quad g(x) = f(x).$$
\end{Theorem}

\begin{Proof}
	因为 $K \subset \R^n$ 是紧集, $f \in C(K)$, 所以 $f$ 在 $K$ 上取得最大值和最小值. 记
	$$M_0 = \displaystyle\max_{x \in K} f(x),\quad m_0 = \displaystyle\min_{x \in K} f(x),\quad f_0(x) = f(x) - \dfrac{M_0 + m_0}{2},\quad x \in K,$$
	则有
	$$-\dfrac{M_0 - m_0}{2} \leq f_0(x) \leq \dfrac{M_0 - m_0}{2}.$$
	记 $a_0 = \dfrac{M_0 - m_0}{2}$, $a_0$ 为 $f_0$ 在 $K$ 上的最大值, $-a_0$ 为 $f_0$ 在 $K$ 上的最小值. 令
\begin{align*}
	A_0 &= \lb x \in K : -a_0 \leq f_0(x) \leq -\dfrac{1}{3} a_0 \rb, \\
	B_0 &= \lb x \in K : \dfrac{1}{3} a_0 \leq f_0(x) \leq a_0 \rb, \\
	C_0 &= \lb x \in K : -\dfrac{1}{3} a_0 \leq f_0(x) \leq \dfrac{1}{3} a_0 \rb,
\end{align*}
则 $A_0,~B_0,~C_0$ 都是紧的, 因为 $f \in C(K)$. 注意到 $A_0 \cap B_0 = \varnothing$, 由推论 \ref{cor:KFab}, 存在 $g_0 \in C(\R^n)$, 使得
	$$g_0(x) = -\dfrac{1}{3}a_0,\quad x \in A_0,\qquad g_0(x) = \dfrac{1}{3}a_0,\quad x \in B_0,\qquad |g_0(x)| \leq \dfrac{1}{3}a_0,\quad x \in \R^n.$$
则有
	$$f_0(x) - g_0(x) \geq -\dfrac{2}{3} a_0, x \in A_0,\quad f_0(x) - g_0(x) \leq \dfrac{2}{3} a_0, x \in B_0,\quad -\dfrac{2a_0}{3} \leq f_0(x) - g_0(x) \leq \dfrac{2a_0}{3}, x \in C_0,$$
故 $-\dfrac{2a_0}{3} \leq f_0(x) - g_0(x) \leq \dfrac{2a_0}{3},~x \in K$. 利用上述步骤, 存在 $g_1 \in C(\R^n)$ 满足
	$$\begin{matrix}
		|g_1(x)| \leq \dfrac{1}{3}\(\dfrac{2}{3} a_0\),\quad x \in \R^n,\\
		\max g_1(x) = \dfrac{1}{3}\(\dfrac{2}{3} a_0\),\quad \min g_1 (x) = -\dfrac{1}{3}\(\dfrac{2}{3} a_0\),\\
		-\dfrac{2}{3}\(\dfrac{2}{3} a_0\) \leq f_0(x) - g_0(x) - g_1(x) \leq \dfrac{2}{3}\(\dfrac{2}{3} a_0\),\quad x \in K.
	\end{matrix}$$
仿此继续, 存在 $C(\R^n)$ 中一列函数 $\lb g_k \rb$ 满足:
\begin{enumerate}
	\item $|g_k (x)| \leq \dfrac{2a_0}{3^{k + 1}},~x \in \R^n$,
	\item $\max g_k(x) = \dfrac{2a_0}{3^{k + 1}}$,
	\item $\min g_k(x) = -\dfrac{2a_0}{3^{k + 1}}$,
	\item $\lv f_0(x) - \dsum_{j = 0}^{k} g_j (x) \rv \leq \(\dfrac{2}{3}\)^{k + 1} a_0,~x \in K$.
\end{enumerate}
故 $\dsum_{j = 0}^{\infty} g_j(x)$ 在 $\R^n$ 上一致收敛, 并且
	$$f(x) = \dfrac{M_0 + m_0}{2} + \dsum_{j = 0}^{\infty} g_j(x),\quad \forall x \in K.$$
设
	$$g(x) = \dfrac{M_0 + m_0}{2} + \dsum_{j = 0}^{\infty} g_j(x),\quad \forall x \in \R^n,$$
	则 $g$ 是连续函数且满足 $m_0 \leq g \leq M_0$.
\end{Proof}

\section{一致收敛, 几乎处处收敛, 依测度收敛关系}

\begin{Theorem}[Егоров 定理] 设 $m(E) < \infty$, $f_k,~f$ 在 $E$ 上几乎处处有限, $k \to \infty$ 时, 在 $E$ 上几乎处处有 $f_k(x) \to f(x)$. 则任意 $\delta > 0$, 存在 $E_\delta \subset E$ 使得 $m(E \setminus E_\delta) < \delta$ 且 $\lb f_k \rb$ 在 $E_\delta$ 上一致收敛于 $f$.
\end{Theorem}

\begin{Example}
	$$f_k(x) = \lb \begin{array}{ll}
		x^k, & 0 \leq x < 1, \\
		(x - 1)^k, & 1 \leq x < 2, \\
\end{array}\right.$$
则有
	$$\displaystyle\lim_{k \to \infty} f_k(x) = 0 = f(x),\quad \displaystyle\lim_{k \to \infty} \sup_{0 \leq x < 2} \lv f_k(x) - f(x) \rv = 1.$$

\end{Example}

\begin{Proof}
	不妨设 $\lb f_k \rb$ 在 $E$ 上处处收敛于 $f$. 由书上习题 3.1 的 14 题 \footnote{书上 53 页“我们知道”一句证明了.} 可得
	\begin{align*}
		E = A &= \dbigcap_{m = 1}^\infty \dbigcup_{i = 1}^\infty \dbigcap_{j = i}^\infty E\(\lv f_j - f \rv < \dfrac{1}{m}\),\\
		\Rightarrow \varnothing &= \dbigcup_{m = 1}^\infty \dbigcap_{i = 1}^\infty \dbigcup_{j = i}^\infty E\(\lv f_j - f \rv \geq \dfrac{1}{m}\),\\
		\Rightarrow \varnothing &= \dbigcap_{i = 1}^\infty \dbigcup_{j = i}^\infty E\(\lv f_j - f \rv \geq \dfrac{1}{m}\),\quad \forall m = 1, 2, \cdots.
	\end{align*}
	记 $B_i(m) = \dbigcup_{j = i}^\infty E\(\lv f_j - f \rv \geq \dfrac{1}{m}\)$, 则
	$$B_1(m) \supset B_2(m) \supset \cdots \supset B_i(m) \supset \cdots.$$
	于是由例 \ref{exm:LimCou} 可得
	$$\lim_{i \to \infty} \lv B_i(m) \rv = \lv \dbigcap_{i = 1}^\infty B_i(m) \rv = 0,\quad \text{因为}~B_1(m) \subset E, \lv E \rv < \infty.$$
	对于任意的 $\delta > 0$, $m = 1$ 时, 取 $i_1$ 使得 $\lv B_{i_1}(1) \rv < \dfrac{\delta}{2}$. $m = 2$ 时, 取 $i_2 > i_1$ 使得 $\lv B_{i_2}(2) \rv < \dfrac{\delta}{2^2}$. 用归纳法, 若已取出 $i_1, i_2, \cdots, i_k$ 满足
	$$i_1 < i_2 < \cdots < i_k,\quad \lv B_{i_l}(l) \rv < \dfrac{\delta}{2^l},\quad l = 1, 2, \cdots, k,$$
	再由 $\displaystyle\lim_{i \to +\infty} \lv B_i(k + 1) \rv = 0$, 可取 $i_{k + 1} > i_k$, 使得 $\lv B_{i_{k + 1}}(k + 1) \rv < \dfrac{\delta}{2^{k + 1}}$. 仿此继续, 可以得到一个严格递增的正整数列 $\lb i_k \rb$ 满足 $\lv B_{i_k} (k) \rv < \dfrac{\delta}{2^k}, k = 1, 2, \cdots$. 于是
	$$B = \dbigcup_{k = 1}^\infty B_{i_k} (k) = \dbigcup_{k = 1}^\infty \dbigcup_{j = i_k}^\infty E\(\lv f_j - f \rv \geq \dfrac{1}{k}\),\quad \lv B \rv \leq \dsum_{k = 1}^{\infty} \lv \dbigcup_{j = i_k}^\infty E\(\lv f_j - f \rv \geq \dfrac{1}{k}\) \rv < \dsum_{k = 1}^{\infty} \dfrac{\delta}{2^k} = \delta.$$

	下面验证 $\lb f_k \rb$ 在 $E \setminus B$ 上一致收敛于 $f$. 注意到
	$$E \setminus B = \dbigcap_{k = 1}^\infty \dbigcap_{j = i_k}^\infty E\(\lv f_j - f \rv < \dfrac{1}{k}\),$$
	对于任意的 $\varepsilon > 0$, 取 $k \in \N_+, \dfrac{1}{k} < \varepsilon$, 由
	$$E \setminus B \subset \dbigcap_{j = i_k}^\infty E\(\lv f_j - f \rv < \dfrac{1}{k}\),$$
	当 $j \geq i_k$ 时, 任意 $x \in E \setminus B$, 都有 $x \in E\(\lv f_j - f \rv < \dfrac{1}{k}\)$, 即 $\lv f_j - f \rv < \dfrac{1}{k} < \varepsilon$.

	综上所述, 任意的 $\varepsilon > 0$, 存在 $i_k \in \N_+$, 使得 $j \geq i_k$ 时, 有 $\lv f_j - f \rv < \varepsilon, \forall x \in E \setminus B$. 故 $\lb f_k \rb$ 在 $E \setminus B$ 上一致收敛.
\end{Proof}

\begin{Definition}
	设函数列 $\lb f_k \rb$ 及函数 $f$ 定义在可测集 $E$ 上, 且几乎处处有限. 若
	$$\forall \sigma > 0,\quad \lv E\(\lv f_k - f \rv \geq \sigma\) \rv \to 0,\quad k \to \infty,$$
	则 $\lb f_k \rb$ 在 $E$ 上依测度收敛于 $f$, 记为 $f_k \xrightarrow{m} f$ 在 $E$ 上.
\end{Definition}

\begin{Example}
	$$f_k(x) = \lb \begin{array}{ll}
		x^k,		& 0 \leq x < 1, \\
		(x - 1)^k,	& 1 \leq x < 2.
	\end{array}\right.\quad k \in \N_+.$$
	则有 $\dlim_{k \to \infty} f_k(x) = 0 = f(x)$, 而 $\sup \lv f_k(x) - f(x) \rv = 1$. 令
	$$E \setminus E_\delta = [0, 2) \setminus \l[1 - \dfrac{\delta}{2}, 1\) \setminus \l[2 - \dfrac{\delta}{2}, 2\),$$
	有
	$$\lim_{k \to \infty} \sup_{x \in E \setminus E_\delta} \lv f_k(x) - f(x) \rv = \lim_{k \to \infty} \(1 - \dfrac{\delta}{2}\)^k = 0,\quad 0 < \delta < 1.$$

\end{Example}

\begin{Proposition}[简单性质]
	若 $f_k \xrightarrow{m} f, g_k \xrightarrow{m} g$ 在 $E$ 上, 则 $f_k + g_k \xrightarrow{m} f + g$ 在 $E$ 上, 且任意的 $\alpha \in \R$, $\alpha f_m \xrightarrow{m} \alpha f$ 在 $E$ 上.
\end{Proposition}

证明提示: $E\(\lv f_k + g_k - (f + g)\rv \geq \sigma \) \subset E\( \lv f_k - f \rv \geq \dfrac{\sigma}{2}\) \cup E\( \lv g_k - g \rv \geq \dfrac{\sigma}{2}\)$.

\begin{Theorem}
	设 $|E| < \infty$, $f_k, f$ 在 $E$ 上可测并且都取有限值. 如果在集合 $E$ 上 $f_k \xra{\text{a.e.}} f$, 则 $f_k \xra{m} f$.
\end{Theorem}

\begin{Proof}
	由 Егоров 定理, 任意的 $\sigma > 0$, $\delta > 0$, 存在 $E_\delta \subset E$, 使得 $\lv E \setminus E_\delta \rv < \delta$, 且 $\lb f_k \rb$ 在 $E_\delta$ 上一致收敛于 $f$. 这样的话, 对于上述 $\sigma > 0$, 存在 $N \in \N_+$, 使得 $k > N$ 时, 对于任意的 $x \in E_\delta$ 成立 $\lv f_k (x) - f(x) \rv < \sigma$. 进而 $k > N$ 时, 有
	$$E\(\lv f_k - f \rv \geq \sigma\) \subset E \setminus E_\delta,\quad \lv E\(\lv f_k - f \rv \geq \sigma\) \rv \leq \lv E \setminus E_\delta \rv < \delta.$$
	所以 $\dlim_{k \to \infty} \lv E\(\lv f_k - f \rv \geq \sigma \) \rv = 0$.
\end{Proof}

\begin{Example}
	记 $I = [0, 1]$, 设
	$$f_1(x) = \chi_{[0, 1]} (x),\quad f_2(x) = \chi_{\l[0, \frac{1}{2}\r]}(x),\quad f_3(x) = \chi_{\l[\frac{1}{2}, 1\r]},\quad \cdots,\quad f_{\frac{k(k - 1)}{2} + j} = \chi_{\l[ \frac{j - 1}{k}, \frac{j}{k} \r]}.$$
	得到一个函数列 $\lb f_k \rb$. 取 $f = 0$, 对于任意的 $\sg > 0$, 有
	$$E\( \lv f_{\frac{k(k - 1)}{2} + j} - f \rv \geq \sg \) = \lb \begin{array}{ll}
		\varnothing, & \sg > 1, \\
		\l[ \dfrac{j - 1}{k}, \dfrac{j}{k} \r], & 0 < \sg \leq 1.
	\end{array}\right.$$
	进而
	$$\lv E\(\lv f_{\frac{k(k - 1)}{2} + j} - f \rv \geq \sg \) \rv \leq \dfrac{1}{k},\quad j = 1, \cdots, k,$$
	故
	$$\dlim_{k\to \infty} \lv E\(\lv f_{\frac{k(k - 1)}{2} + j} - f \rv \geq \sg \) \rv = 0,$$
	即 $\lb f_k \rb$ 在 $E$ 上依测度收敛于 $0$. 任意 $x \in [0, 1]$, 有无穷多 $f_k(x) = 0$, 有无穷多 $f_k(x) = 1$. 所以 $\lb f_k (x)\rb$ 不收敛, 进而 $\lb f_k \rb$ 在 $E$ 上不收敛.
\end{Example}

\begin{Theorem}[F. Riesz 定理]
	设在可测集 $E$ 上, $f_k \xrightarrow{m} f, k \to \infty$, 则 $\lb f_k \rb$ 有子列 $\lb f_{n_j} \rb$ 在 $E$ 上几乎处处收敛.
\end{Theorem}

\begin{Proof}
	由测度收敛定义, 对于每一个 $l \in \N_+$ 都有
	$$\dlim_{k \to \infty} \lv E\(\lv f_k - f \rv \geq \dfrac{1}{l}\) \rv = 0.$$
	这样的话, 可以取到一个严增的正整数列 $\lb k_j \rb$, 使得 $k \geq k_j$ 时, 有
	$$\lv E\(\lv f_k - f \rv \geq \dfrac{1}{j}\) \rv < \dfrac{1}{2^j},\quad j = 1, 2, \cdots.$$
	记
	$$E_0 = \dbigcap_{l = 1}^{\infty}\dbigcup_{j = l}^{\infty} E\( \lv f_{k_j} - f \rv \geq \dfrac{1}{j} \),$$
	有
	\begin{align*}
		\lv E_0 \rv &= \lim_{l \to \infty} \lv \dbigcup_{j = l}^{\infty} E\( \lv f_{k_j} - f \rv \geq \dfrac{1}{j} \)\rv \\
		& \leq \lim_{l \to \infty} \dsum_{j = l}^{\infty} \lv E\( \lv f_{k_j} - f \rv \geq \dfrac{1}{j} \) \rv \\
		& \leq \lim_{l \to \infty} \dsum_{j = l}^{\infty} \dfrac{1}{2^j} = \lim_{l \to \infty} \dfrac{1}{2^{l - 1}} = 0, \\
		E \setminus E_0 &= \dbigcup_{l = 1}^{\infty}\dbigcap_{j = l}^{\infty} E\( \lv f_{k_j} - f \rv < \dfrac{1}{j} \).
	\end{align*}
	下证 $\lb f_{k_j} \rb$ 在 $E \setminus E_0$ 上收敛于 $f$. 对于任意的 $x \in E \setminus E_0$, 存在 $l_0 \in \N_+$, 使得
	$$x \in \dbigcap_{j = l_0}^{\infty} E\(\lv f_{k_j} - f \rv < \dfrac{1}{j}\).$$
	故 $j \geq l_0$ 时,
	$$x \in E\(\lv f_{k_j} - f \rv < \dfrac{1}{j}\),$$
	即 $\lv f_{k_j}(x) - f(x) \rv < \dfrac{1}{j}$, 进而 $\dlim_{j \to \infty} \(f_{k_j}(x) - f(x)\) = 0$. 因此, $\lb f_{k_j} \rb$ 在 $E$ 上几乎处处收敛于 $f$.
\end{Proof}

\begin{Remark}
	上述证明约定: 相减时不会同时取无穷大.
\end{Remark}

总结:

\begin{itemize}
	\item 一致收敛 $\xra{}$ 几乎处处收敛.
	\item 几乎处处收敛 $\xrightarrow{\lv E \rv < \infty,~\text{Егоров 定理条件}}$ 一致收敛.
	\item 几乎处处收敛 $\xrightarrow{\lv E \rv < \infty}$ 依测度收敛.
	\item 依测度收敛 $\xrightarrow{\text{某子列上成立}}$ 几乎处处收敛.
\end{itemize}

\section{Лузин 定理}

\begin{Lemma}\label{lem:LujinLem}
	设 $\phi$ 为 $E$ 上的简单函数. 任给 $\ep > 0$, 存在闭集 $F \subset E$, 使得 $\phi \in C(F)$ 且 $|E \setminus F| < \ep$.
\end{Lemma}

\begin{Proof}
	设 $\phi(x) = \dsum_{j = 1}^{k} c_j \chi_{E_j} (x)$. 其中 $c_1, c_2, \cdots, c_k \in \R$, 可测集 $E_1, E_2, \cdots, E_k$ 两两不交, $E = \dbigcup_{j = 1}^k E_j$. 利用开集刻画可测集的定理 \ref{thm:OpenMeas}, 任意 $\ep >  0$, 存在闭集 $F_j \subset E_j$, $j = 1, 2, \cdots, k$, 使得 $|E_j \setminus F_j| < \dfrac{\ep}{k}$. 记 $F = \dbigcup_{j = 1}^k F_j$, $F$ 是闭集, 有
	$$\lv E \setminus F \rv = \lv \dbigcup_{j = 1}^k E_j \setminus \dbigcup_{j = 1}^k F_j \rv = \lv \dbigcup_{j = 1}^k \( E_j \setminus F_j \) \rv < \ep.$$
	下证 $\phi$ 在 $F$ 上相对连续. 对于任意的 $x \in F$, 存在 $j \in \lb 1, 2, \cdots, k\rb$, 使得 $x \in F_j, x \notin F_i, i \neq j, \phi(x) = c_j$. 由 $x \in \(\dbigcup_{i \neq j} F_i\)^c$ 且 $\(\dbigcup_{i \neq j} F_i\)^c$ 是开集, 存在 $x$ 的一个邻域 $B(x, \de) \subset \(\dbigcup_{i \neq j} F_i\)^c$, 即 $B(x, \de) \cap F_j \subset F_j$. 进而 $\phi(x) \equiv c_j$, $x \in B(x, \de) \cap F_j$, 故 $x$ 是 $\phi$ 相对 $F_j$ 的连续点.
\end{Proof}

\begin{Theorem}[Лузин 定理]
	设 $f$ 为 $E$ 上的可测函数且几乎处处有限, 那么, 任给 $\ep > 0$, 存在闭集 $F \subset E$, 使得 $f \in C(F)$ 且 $|E \setminus F| < \ep$.
\end{Theorem}

\begin{Proof}
	不妨认为 $f$ 在 $E$ 上处处有限. 利用简单函数与可测函数的关系, 存在一个简单函数列 $\lb \phi_k \rb$ 在 $E$ 上处处收敛于 $f$. $|E| < \infty$ 时, 先用 Егоров 定理, 使 $\lb \phi_k \rb$ 在 $E_0$ 上一致收敛于 $f$ 且 $|E \setminus E_0| < \dfrac{\ep}{2}$. 次之, 由引理 \ref{lem:LujinLem}, 对于每个 $k$, 存在闭集 $F_k \subset E_0$, 使得 $\phi_k |_{F_k}$ 相对于 $F_k$ 连续且 $\lv E_0 \setminus F_k \rv < \dfrac{\ep}{2^{k + 1}}$.

	记 $F = \dbigcap_{k = 1}^\infty F_k = \dbigcap_{k = 1}^\infty F_k \cap E_0$. 于是
	$$E \setminus F = \dbigcup_{k = 1}^\infty (E \setminus F_k) \cup (E \setminus E_0),\quad |E \setminus F| < \dfrac{\ep}{2} + \dsum_{k = 1}^{\infty} \dfrac{\ep}{2^{k + 1}} = \ep.$$
	此时, $\lb \phi_k \rb$ 在 $F$ 上一致收敛于 $f$ 且对于每个 $k \in \N_+$, $\phi_k |_F$ 相对于 $F$ 连续. 由一致收敛函数列的连续性定理, $f|_F$ 在 $F$ 上相对连续.

	$|E| = \infty$ 时, 对每个 $k \in \N_+$, 记 $E_k = E \cap \lb x \in \R^n : k - 1 \leq |x| < k \rb$. $\lb E_k \rb$ 是两两不交, 测度有限的可测集列, 且 $E = \dbigcup_{k = 1}^\infty E_k$. 对每个 $E_k$ 用前面证实的结果: 对上述 $\ep > 0$, 存在闭集 $G_k \subset E_k$, 使得 $|E_k \setminus G_k| < \dfrac{\ep}{2^k}$, $f|_{G_k}$ 相对于 $G_k$ 连续.

	记 $G = \dbigcup_{k = 1}^\infty G_k$. 下面说明:
	\begin{enumerate}
		\item $G$ 是闭集,
		\item $|E \setminus G| < \ep$,
		\item $f|_G$ 相对于 $G$ 是连续的.
	\end{enumerate}

	任意 $x \in \ol{G}$, 在 $G$ 中存在一个点列 $\lb x_k \rb$, 使得 $|x_k - x| \to 0$, $k \to \infty$. 存在 $r \in \N_+$ 使得 $|x| < r$. 由 $\dlim_{k \to \infty} |x_k| = |x| < r$. 当 $k$ 充分大时, $|x_k| < r$. 此时, $x_k \in \dbigcup_{j = 1}^r G_j$. 因为 $\dbigcup_{j = 1}^r G_j$ 是闭集, 所以 $x_k \to x \in \dbigcup_{j = 1}^r G_j$, $k \to \infty$, 进而 $x \in G$. 故 $\ol{G} \subset G$, $G$ 是闭集.

	因为 $\lb E_k \rb$ 两两不交且 $G_k \subset E_k$, $k \in \N_+$, 所以
	$$E \setminus G = \(\dbigcup_{k = 1}^\infty E_k\) \setminus \(\dbigcup_{k = 1}^\infty G_k\) = \dbigcup_{k = 1}^\infty \(E_k \setminus G_k\).$$
	进而
	$$|E \setminus G| \leq \dsum_{k = 1}^{\infty} \lv E_k \setminus G_k \rv < \dsum_{k = 1}^{\infty} \dfrac{\ep}{2^k} = \ep.$$

	下证 $f|_G$ 相对于 $G$ 是连续的. 对于任意的 $x \in G$, 因为 $\lb G_k \rb$ 是两两不交的闭集列, 所以存在唯一一个 $G_k$, 使得 $x \in G_k$. 容易说明 \footnote{书上 30 页 12 题 (3).}
	$$\delta_x := d(x, G_l) > 0,\quad l \neq k,\quad \(B(x, \delta_x) \cap G_k\) \cap G_l = \varnothing,\quad l \neq k.$$
	由 $f|_{G_k}$ 相对于 $G_k$ 连续, 任意 $\eta > 0$, 存在 $\delta > 0$, $|y - x| < \delta$ 且 $y \in G_k$ 时, $\lv f|_{G_k}(x) -f|_{G_k}(y) \rv < \eta$. 于是
	$$y \in B(x, \min\lb \delta,~\delta_x \rb) \cap G \subset B(x, \delta_x) \cap G_k\quad \Rightarrow\quad \lv f|_G(y) - f|_G(x) \rv = \lv f|_{G_k}(y) - f|_{G_k}(x) \rv < \eta.$$
	故 $f|_G$ 相对于 $G$ 是连续的.
\end{Proof}

\begin{Corollary}
	设 $f$ 在 $E$ 上有界, 可测且几乎处处有限. 则任意 $\ep > 0$, 存在 $g \in C(\R^n)$ 使得 $|E(f \neq g)| < \ep$ 且 $|g(x)| \leq \displaystyle\sup_{x \in E} |f(x)|$.
\end{Corollary}

\begin{Proof}
	$|E| < \infty$ 时, 令 $E_k = E \cap B(O; k)$, $\forall k \in \N_+$. 由 $|E| = \dlim_{k \to \infty} |E_k|$, 对于任意 $\ep > 0$, 存在 $k_0$ 使得 $|E| < |E_{k_0}| + \dfrac{\ep}{2}$, 即 $|E \setminus E_{k_0}| < \dfrac{\ep}{2}$. 由 Лузин 定理, 存在闭集 $F \subset E_{k_0}$, 使 $\lv E_{k_0} \setminus F \rv < \dfrac{\ep}{2}$ 且 $f|_F$ 相对于 $F$ 连续. 此时 $F$ 是紧的且
	$$\lv E \setminus F \rv \leq |E \setminus E_{k_0}| + |E_{k_0} \setminus F| < \dfrac{\ep}{2} + \dfrac{\ep}{2} = \ep.$$
	再用延拓定理 (定理 \ref{thm:Extend}), 存在 $g \in C(\R^n)$ 使 $g|_F = f$ 且 $|g(y)| \leq \dsup_{x \in F}|f(x)|$, $\forall y \in \R^n$. 此时有
	$$|E(f \neq g)| \leq |E \setminus F| < \ep,\quad |g(y)| \leq \dsup_{x \in F} |f(x)| \leq \dsup_{x \in E} |f(x)|.$$

	$|E| = \infty$ 时, 提示如下.
	$$E = \dbigcup_{k = 1}^\infty E_k,\quad E_k = E \cap \lb x \in \R^n : k - 1 \leq |x| < k \rb,\quad k \in \N_+,$$
	故 $\lb E_k \rb$ 两两不交. 令
	$$g = \dsum_{k = 1}^\infty \lambda_k g_k,\quad \lambda_1(x) = \lb\begin{array}{ll}
		1, & x \in K_1, \\
		0, & |x| \geq 1,% + \delta_1
	\end{array}\right.\quad \lambda_2(x) = \lb\begin{array}{ll}
		1, & x \in K_2, \\
		0, & |x| \leq 1, |x| > 2,% + \delta_2,
	\end{array}\right.\quad \cdots,$$
	其中 $K_k$ 是由 Лузин 定理取得的 $E_k$ 中的闭集.
\end{Proof}

\chapter{Lebesgue 积分及其基本理论}

\section{Lebesgue 积分的定义及基本性质}

\begin{Example}
	零测集 $E$ 上的任何函数的积分均为 0.
\end{Example}

\begin{Proof}
	设 $f : E \to \oR$, $|E| = 0$. 任取一个非负简单函数, 使得 $0 \leq \p \leq f^+$. 则记
	$$\p(x) = \dsum_{j = 1}^{k} c_j \chi_{E_j} (x),\quad E = \dbigcup_{j = 1}^k E_j.$$
	$E_1, E_2, \cdots, E_k$ 两两不交且为零测集. 于是
	$$\dint_E \p = \dsum_{j = 1}^{k} c_j |E_j| = 0.$$
	故
	$$\dint_E f^+ = \sup\lb \dint_E \p : 0 \leq \p \leq f^+,~\p~\text{是简单函数}\rb = 0.$$
	同理 $\dint_E f^- = 0$. 故 $f \in L(E)$, 且 $\dint_E f = 0$.
\end{Proof}

\begin{Example}\label{exm:LeqLE}
	设 $f, g$ 是 $E$ 上的非负可测函数且 $0 \leq g \leq f$. 若 $f \in L(E)$, 则 $g \in L(E)$.
\end{Example}

\begin{Proof}
	按积分定义
	\begin{align*}
		\int_{E} f = \sup \lb \int_E \p : 0 \leq \p \leq f,~\p ~ \text{是简单函数} \rb, \\
		\int_{E} g = \sup \lb \int_E \p : 0 \leq \p \leq g,~\p ~ \text{是简单函数} \rb, \\
		\lb \int_E \p : 0 \leq \p \leq g,~\p ~ \text{是简单函数} \rb \subset \lb \int_E \p : 0 \leq \p \leq f,~\p ~ \text{是简单函数} \rb.
	\end{align*}
\end{Proof}

\begin{Lemma}[简单函数积分的良定义]
	非负简单函数的积分与它的表示无关.
\end{Lemma}

\begin{Proof}
	设
	$$\begin{array}{lll}
		\p (x) = \dsum_{j = 1}^{k} c_j \chi_{E_j}(x),& E = \dbigcup_{j = 1}^k E_j, &E_1, \cdots, E_k~\text{两两不交且可测}, \\
		\p (x) = \dsum_{i = 1}^{l} d_i \chi_{F_i}(x),& E = \dbigcup_{i = 1}^l F_i, &F_1, \cdots, F_l~\text{两两不交且可测}.
	\end{array}$$
	下面说明 $\dsum_{j = 1}^k c_j |E_j| = \dsum_{i = 1}^l d_i |F_i|.$ 注意到 $E = E \cap E = \dbigcup_{j = 1}^{k} \dbigcup_{i = 1}^{l}\( E_j \cap F_i\)$ 为不交并, 以及 $E_j \cap F_i \neq \varnothing$ 时, $c_j = d_i$. 因为 $E_j = E_j \cap E = \dbigcup_{i = 1}^l \(E_j \cap F_i\)$ 为不交并, 所以
	$$\dint_E \p = \dsum_{j = 1}^{k} c_j |E_j| = \dsum_{j = 1}^{k} \dsum_{i = 1}^{l} c_j |E_j \cap F_i|.$$
	进一步,
	\begin{align*}
	\dint_E \p &= \dsum_{i = 1}^{l} \dsum_{j = 1}^{k} c_j |E_j \cap F_i| = \dsum_{i = 1}^{l} \dsum_{j = 1}^{k} d_i |E_j \cap F_i| \\
	&= \dsum_{i = 1}^{l} d_i \dsum_{j = 1}^{k} |E_j \cap F_i| = \dsum_{i = 1}^{l} d_i |F_i|,
	\end{align*}
	其中用到了 $F_i = \dbigcup_{j = 1}^k \(E_j \cap F_i\)$ 是不交并.
\end{Proof}

\begin{Lemma}~

	(1) 设 $\p$ 为 $E$ 上非负简单函数, $e \subset E$ 可测, 则 $0 \leq \dint_e \p \leq M|e|$, 其中 $M = \displaystyle\sup_{x \in E} \p(x).$

	(2) 若 $\dint_E \p = +\infty$, 则任意 $N > 0$, 存在 $A \subset E$ 可测且 $|A| < \infty$, 使 $\dint_A \p > N$.
\end{Lemma}

\begin{Lemma}[基本引理]
	设 $f$ 在 $E$ 上非负可测, $\p_m$ 是简单函数且 $0 \leq \p_m \leq \p_{m + 1}$, $m \in \N_+$. 如果对于任意的 $x \in E$, $\dlim_{m \to \infty} \p_m(x) =  f(x)$ 成立, 那么 $\dint_E f = \dlim_{m \to \infty} \dint_E \p_m$.
\end{Lemma}

\begin{Proof}
	$\dint_{E} f = 0$ 显然.

	$\dint_{E} f > 0$ 时, 由
	$$0 \leq \dint_{E} \p_k \leq \dint_{E} f,\quad \dint_{E} \p_k \leq \dint_{E} \p_{k + 1},\quad k \in \N_+,$$
	可得 $\dlim_{k \to \infty} \dint_{E} \p_k \leq \dint_E f$.

	下面证明 $\dint_E f \leq \dlim_{k \to \infty} \dint_E \p_k$. 这个事实等价于任意 $a  > 0$, $a < \dint_E f$, 都有 $\dlim_{k \to \infty} \dint_E \p_k > a$. 设 $a > 0$, $a < \dint_E f$. 由积分定义, 存在非负简单函数 $\p$ 满足 $0 \leq \p \leq f$, $\dint_E \p > a$. 定义 $\lb \min\(\p_k, \p\) \rb$, 满足
	$$0 \leq \min \(\p_k, \p\) \leq \min \(\p_{k + 1}, \p\),\quad \dlim_{k \to \infty} \min \(\p_k, \p\)= \min\(f, \p\) = \p.$$

	$\dint_E \p < +\infty$ 时, 记 $A = \lb x \in E : \p(x) > 0 \rb$. 由 $\p$ 是 $E$ 上的简单函数, 存在 $c > 0, M > 0$ 使得
	$$0 < c \leq \p(x) \leq M,\quad x \in A,\qquad \p(x) = 0,\quad x \in E \setminus A,$$
	显然 $|A| < \infty$. 由 Егоров 定理, 对任意给定的 $\ep > 0,$ 存在 $A$ 的一个可测子集 $A_0$, 使得 $|A \setminus A_0| < \ep$ 且 $\lb \min\(\p_k, \p\) \rb$ 在 $A_0$ 上一致收敛于 $\p$. 对于上述 $\ep > 0$, 由一致收敛的定义, 存在 $k_0 \in \N_+$, $k \geq k_0$ 时, $\lv\min\(\p_k(x), \p(x)\) - \p(x)\rv < \ep$ 对一切 $x \in A_0$ 成立. 这样的话, $k > k_0$ 时,
	\begin{align*}
		\lv \int_{E} \min\( \p_k, \p \) - \int_{E} \p \rv &= \lv \int_{A} \min\( \p_k, \p \) - \int_{A} \p \rv \\
		&= \lv \int_{A_0} \( \min\( \p_k, \p \) - \p \) + \int_{A \setminus A_0} \( \min\( \p_k, \p \) - \p \) \rv \\
		&\leq \int_{A_0} \lv \min\( \p_k, \p \) - \p \rv + \int_{A \setminus A_0} \lv \min\( \p_k, \p \) - \p \rv \\
		&\leq \ep |A_0| + 2M |A \setminus A_0| < \ep |A_0| + 2M \ep = \ep \(|A| + 2M\).
	\end{align*}
	由 $\ep$ 的任意性, $\dlim_{k \to \infty} \dint_E \min (\p_k, \p) = \dint_E \p$. 于是
	$$a < \dint_E \p = \dlim_{k \to \infty} \dint_E \min(\p_k, \p) \leq \dlim_{k \to \infty} \int_{E} \p_k.$$

	$\dint_E \p = +\infty$ 时, 记 $\p(x) = \dsum_{j = 1}^l c_j \chi_{E_j} (x)$, $x \in E$, 其中 $E = \dbigcup_{j = 1}^l E_j$, $E_1, \cdots, E_l$ 两两不交并且可测, $c_1, \cdots, c_l$ 为非负实数, 此时
	$$\dint_E \p = \dsum_{j = 1}^{l} c_j |E_j| = +\infty.$$
	于是存在 $j_0$, 使得 $c_{j_0} |E_{j_0}| = +\infty$. 存在可测集 $F$, $F \subset E_{j_0}$, 使得 $c_{j_0} |F| > a$, 此时 $F$ 的测度有限. 由 $\dlim_{k \to \infty} \min\(\p_k, \p\) = \p$, 在 $F$ 上也有 $\dlim_{k \to \infty} \min\(\p_k(x), \p(x)\) = \p(x)$. 由 Егоров 定理, 对任意 $\ep > 0$, 存在 $F$ 的可测子集 $F_0$, 使得 $|F \setminus F_0| < \ep$, 且 $\lb \min\( \p_k, \p \) \rb$ 在 $F_0$ 上一致收敛于 $\p$. 记 $c = c_{j_0}$, $M = \dmax_{x \in F} \p(x)$. 对上述 $\ep > 0$, 存在 $k_0 \in \N_+$, 当 $k \geq k_0$ 时, 对任意 $x \in F$ 成立
	$$\lv \min\( \p_k(x), \p(x) \) - \p(x) \rv < \ep.$$
	于是
	\begin{align*}
		0 & \leq \int_F \p  - \int_F \min\(\p_k, \p\) = \int_{F_0} \(\p  - \min\(\p_k, \p\)\) + \int_{F \setminus F_0} \(\p  - \min\(\p_k, \p\)\) \\
		&< \ep |F_0| + 2M|F \setminus F_0| < \ep \(|F| + 2M\).
	\end{align*}
	故 $\dlim_{k \to \infty} \dint_F \min(\p_k, \p) = \dint_F \p$, 进而
	$$a < \dint_F \p = \dlim_{k \to \infty} \dint_F \min(\p_k, \p) \leq \dlim_{k \to \infty} \int_{F} \p_k \leq \lim_{k \to \infty} \int_{E} \p_k.$$

	综上所述, $\dlim_{k \to \infty} \dint_E \p_k > a$. 故 $\dlim_{k \to \infty} \dint_E \p_k \geq \dint_E f.$~
\end{Proof}

\begin{Remark}~
	\begin{enumerate}
		\item 设 $f \in L(E)$, 则 $f$ 在 $E$ 上几乎处处有限. \label{enu:fLE}
		\item 若 $f,~g \in L(E)$, 约定

		$$f(x) + g(x) = \lb\begin{array}{ll}
			f(x) + g(x), & f(x),~g(x)~\text{不是异号无穷大}, \\
			0, & f(x),~g(x)~\text{是异号无穷大}.
		\end{array}\right.$$
	\end{enumerate}
\end{Remark}

\begin{Proof}[\ref{enu:fLE}]
	不妨设 $f \geq 0$,
	\begin{align*}
		E(f > 1) \supset E(f > 2) \supset &\cdots \supset E(f > k) \supset \cdots,\\
		k\lv E(f > k) \rv \leq \int_{E} f \chi_{E(f > k)} \leq \int_E f < +\infty,\quad &\Rightarrow\quad \lv E(f > k)\rv \to 0,\quad k \to \infty,\\
		E(f = +\infty) = \dbigcap_{k = 1}^\infty E(f > k) \subset \lv E(f > 1)\rv < \infty\quad &\Rightarrow\quad \lv E(f = +\infty)\rv = \lim_{k \to \infty} \lv E(f > k)\rv = 0.
	\end{align*}
\end{Proof}

\begin{Lemma}\label{lem:alphaf}
	设 $f \geq 0$, $f \geq 0$ 可测. 则 $\dint_E \a f = \a \dint_E f$.
\end{Lemma}

\begin{Proof}
	$f$ 是 $E$ 上的非负简单函数时, 设 $f = \dsum_{j = 1}^k c_j \chi_{E_j}$, $E = \dbu_{j = 1}^k E_j$, $E_1, \cdots, E_k$ 两两不交且可测. $\a > 0$ 时, 有
	$$\a f = \dsum_{j = 1}^k \a c_j \chi_{E_j},\quad \dint_E \a f = \dsum_{j = 1}^k \a c_j \lv E_j \rv = \a \sum_{j = 1}^{k} c_j \lv E_j \rv = \a \dint_E f.$$

	$f$ 是 $E$ 上的非负可测函数时, 存在一个非负简单函数列 $\lb \p_k \rb$ 使得 $0 \leq \p_k \nearrow f$, 则 $\lb \a \p_k \rb$ 也是非负简单函数并且 $\a\p_k \nearrow \a f$, $k \to \infty$, 进而
	\begin{align*}
		\int_E \a f  = \lim_{k \to \infty} \int_E \a \p_k = \a \lim_{k \to \infty} \int_E \p_k = \a \dint_E f.
	\end{align*}
\end{Proof}

\begin{Theorem}
	设 $f, g \in L(E)$, $\a$, $\beta \in \R$, 则 $\a f + \beta g \in L(E)$ 且 $\dint_E \a f + \beta g = \a \dint_E f + \beta \dint_E g$.
\end{Theorem}

\begin{Proof}
	先证 $f + g \in L(E)$. 此时 $f^+,~f^-,~g^+,~g^- \in L(E)$, 先说明 $(f + g)^+,~(f + g)^- \in L(E)$. 因为 $(f + g)^+ = \max (f + g, 0)$, 所以 $f + g \leq f^+ + g^+$, 进而 $(f + g)^+ \leq f^+ + g^+$. 由例 \ref{exm:LeqLE} 可得 $(f + g)^+ \in L(E)$, 同理 $(f + g)^- \in L(E)$. 由
	$$f^+ + g^+ - f^- - g^- = f + g = (f + g)^+ - (f + g)^-,$$
	可得
	\begin{align*}
		(f + g)^+ + f^- + g^- &= f^+ + g^+ + (f + g)^-,\\
		\int_E (f + g)^+ + \int_E f^- + \int_E g^- &= \int_E f^+ + \int_E g^+ + \int_E (f + g)^-.
	\end{align*}
	上式各项有限, 移项
	\begin{align*}
		\int_E (f + g)^+ - \int_E (f + g)^- &= \int_E f^+ - \int_E f^- + \int_E g^+ - \int_E g^-,\\
		\int_E f + g &= \int_E f + \int_E g.
	\end{align*}

	再证对于任意的 $\a \in \R, \a f \in L(E)$. $\a > 0$ 时, $(\a f)^+ = \a f^+$, $(\a f)^- = \a f^-$. 由引理 \ref{lem:alphaf}, 有
	$$\dint_E \a f = \int_E (\a f)^+ - \int_E (\a f)^- = \dint_E \a f^+ - \dint_E \a f^- = \a \dint_E f^+ - \a \dint_E f^- = \a \int_E f.$$
	$\a \leq 0$ 时, $(\a f)^+ = -\a f^-$, $(\a f)^- = -\a f^+$. 由引理 \ref{lem:alphaf}, 有
	\begin{align*}
		\int_E \a f &= \int_E (\a f)^+ - \int_E (\a f)^- = \int_E (-\a) f^- - \int_E (-\a ) f^+ = -\a \int_E f^- + \a \int_E f^+ = \a \int_E f.
	\end{align*}
\end{Proof}

\begin{Theorem}[积分的绝对连续性]
	设 $f \in L(E)$, 对于任意 $\ep > 0$, 存在 $\de > 0$, 只要 $A \subset E$, $A$ 可测并且 $|A| \leq \de$, 就有 $\dint_A |f| < \ep$.
\end{Theorem}

\begin{Proof}
	由积分定义可得 $|f| \in L(E)$. 对于任意 $\ep > 0$, 存在简单函数 $\p$, 满足
	$$0 \leq \p \leq |f|,\quad \dint_E |f| < \int_E \p + \dfrac{\ep}{2},$$
	此时 $\dint_E |f| - \dint_E \p < \dfrac{\ep}{2}$. 对于任意可测子集 $A \subset E$, 都有
	$$\int_A \(|f| - \p\) \leq \int_E \(|f| - \p\) < \dfrac{\ep}{2}.$$
	存在 $M > 0$, 使得 $0 \leq \p \leq M$, 此时
	$$\int_A |f| \leq \int_A \p + \dfrac{\ep}{2} \leq M|A| + \dfrac{\ep}{2}.$$
	取 $\de = \dfrac{\ep}{2M}$, 当 $A \subset E$ 可测且 $|A| < \de$ 时, 都有
	\begin{align*}
		\int_A |f| \leq \int_A \p + \dfrac{\ep}{2} \leq M|A| + \dfrac{\ep}{2} = \dfrac{\ep}{2} + \dfrac{\ep}{2} = \ep.
	\end{align*}
\end{Proof}

\begin{Theorem}\label{thm:EtoEk}
	设 $f$ 是 $E$ 上的非负可测函数, 且 $E = \dbu_{k = 1}^\infty E_k$, $E_k$ 两两不交. 若 $f$ 在 $E$ 上非负可测, 则
	$$\dint_E f = \dsum_{k = 1}^{\infty} \dint_{E_k} f.$$
\end{Theorem}

\begin{Proof}\footnote{此证明后半部分不完整.}
	先设 $f$ 为非负简单函数, 即 $f(x) = \dsum_{j = 1}^l c_j \chi_{F_j}$, $E = \dbu_{j = 1}^l F_j$, 其中 $F_1, \cdots, F_l$ 两两不交, 于是 $\dint_E f = \dsum_{j = 1}^l c_j\lv F_j \rv$. 又有
	$$E = E \cup E = \(\dbu_{j = 1}^l F_j\) \cap \(\dbu_{k = 1}^\infty E_k\) = \dbu_{j = 1}^l \dbu_{k = 1}^\infty \(F_j \cap E_k\),$$
	注意到 $F_j = \dbu_{k = 1}^\infty \(F_j \cap E_k\)$ 且 $\lb F_j \cap E_k \rb$ 两两不交, 可得 $\lv F_j \rv = \dsum_{k = 1}^{\infty} \lv F_j \cap E_k \rv$, 进而
	$$\int_E f = \sum_{j = 1}^l c_j \lv F_j \rv = \sum_{j = 1}^l \sum_{k = 1}^{\infty} c_j \lv F_j \cap E_k \rv = \sum_{k = 1}^{\infty} \(\sum_{j = 1}^l c_j \lv F_j \cap E_k \rv\).$$
	又因为 $f\chi_{E_k} = \dsum_{j = 1}^{l} c_j \chi_{F_j \cap E_k}$, 所以
	$$\int_{E_k} f = \int_E f\chi_{E_k} = \sum_{j = 1}^l c_j \lv F_j \cap E_k \rv.$$
	于是 $\dint_E f = \dsum_{k = 1}^{\infty} \dint_{E_k} f$.

	$f$ 是 $E$ 上的非负可测函数时, 存在一个非负简单函数列 $\lb \p_j \rb$, 使得 $\p_j \nearrow f$, 有 (\textcolor[rgb]{1.00,0.00,0.00}{?????证明有问题})
	\begin{align*}
		\int_E f = \lim_{j \to \infty} \int_E \p_j = \lim_{j \to \infty} \sum_{k = 1}^\infty \int_{E_k} \p_j = \sum_{k = 1}^\infty \lim_{j \to \infty} \int_{E_k} \p_j \geq \sum_{k = 1}^m \lim_{j \to \infty} \int_{E_k} \p_j = \sum_{k = 1}^m \int_{E_k} f.
	\end{align*}
\end{Proof}

\section{积分号下取极限}

数分中, Riemann 可积函数列 $\lb f_k \rb$ 定义在闭区间 $[a, b]$ 上, 存在如下问题.
\begin{enumerate}
	\item $f = \dlim_{k \to \infty} f_k$ 未必 Riemann 可积.
	\item $\lb f_k \rb$ 在 $[a, b]$ 上一致收敛于 $f$, 则 $f \in \Rie[a, b]$ 且 $\dlim_{k \to \infty} \dint_{a}^{b} f_k(x) \di x = \dint_{a}^{b} f(x) \di x = \dint_{a}^{b} \dlim_{k \to \infty} f_k(x) \di x.$
\end{enumerate}

\begin{Theorem}[单调极限定理, Levi 定理]
	设函数 $f_n$ 在 $E$ 上可测且 $0 \leq f_n \leq f_{n + 1}, n \in \N_+$, 那么
	$$\int_E \lim_{n \to \infty} f_n = \lim_{n \to \infty} \int_E f_n.$$
\end{Theorem}

\begin{Proof}
	对每个 $k \in \N_+$, 取一个简单函数列 $\lb \p_{kl} \rb_{l = 1}^{\infty}$ 满足 $0 \leq \p_{kl} \nearrow f_k$, $l \to \infty$. 令
	$$\psi_k = \max\lb \p_{lk} : 1 \leq l \leq k \rb,$$
	则有
	\begin{equation}\label{equ:Levi1}
		0 \leq \psi_k \leq \psi_{k + 1},\quad k = 1, 2, \cdots,\qquad \p_{lk} \leq \psi_k \leq f_k,\quad \forall k,~l \in \N_+.
	\end{equation}
	后一式对 $k$ 取极限可得
	$$f_l = \lim_{k \to \infty} \p_{lk} \leq \lim_{k \to \infty} \psi_k \leq \lim_{k \to \infty}f_k.$$
	再对 $l$ 取极限可得
	$$\lim_{l \to \infty} f_l \leq \lim_{k \to \infty} \psi_k \leq \lim_{k \to \infty}f_k.$$
	所以
	$$\lim_{k \to \infty} \psi_k = \lim_{k \to \infty} f_k.$$
	又因为 $\lb \psi_k \rb$ 是简单函数列, 则由基本引理可得
	\begin{equation}\label{equ:Levi2}
		\lim_{k \to \infty} \int_E \psi_k = \int_{E} \lim_{k \to \infty} \psi_k = \int_E \lim_{k \to \infty} f_k.
	\end{equation}
	由 \eqref{equ:Levi1} 式可得
	\begin{equation}\label{equ:Levi3}
		\dint_E \p_{lk} \leq \dint_E \psi_k \leq \dint_E f_k,\quad k \in \N_+,\quad 1 \leq l \leq k.
	\end{equation}
	由 \eqref{equ:Levi3} 式及 $f_1 \leq f_2 \leq \cdots \leq f_k \leq \cdots \leq \dlim_{k \to \infty} f_k$ 可得
	\begin{equation}\label{equ:Levi4}
		\lim_{k \to \infty} \int_E \psi_k \leq \lim_{k \to \infty} \int_E f_k \leq \int_E \lim_{k \to \infty} f_k.
	\end{equation}
	最后, 由 \eqref{equ:Levi2}, \eqref{equ:Levi4} 式可得 $\dint_E \dlim_{k \to \infty} f_k = \dlim_{k \to \infty} \dint_E f_k$.
\end{Proof}

\begin{Corollary}\label{col:Levi1}
	设 $\lb u_k \rb$ 是在 $E$ 上非负可测函数列, 则 $\dint_E \csum u_k = \csum \dint_E u_k$.
\end{Corollary}

\begin{Proof}
	令 $f_k = \dsum_{l = 1}^k u_l, k \in \N_+$. 则 $0 \leq f_k \leq f_{k  + 1} \nearrow \csum u_k$,
	$$\lim_{k \to \infty} \int_E f_k = \lim_{k \to \infty} \dsum_{j = 1}^k \int_E u_j = \csum \int_E u_k,$$
	且
	\begin{align*}
		\lim_{k \to \infty} \int_E f_k = \int_E \lim_{k \to \infty} f_k = \int_E \csum u_k.
	\end{align*}
\end{Proof}

下面利用推论 \ref{col:Levi1} 给出定理 \ref{thm:EtoEk} 的另一种证明方法.

\begin{Proof}
	由 $f = \dsum_{j = 1}^\infty f \chi_{E_j}$ 及 $\lb f\chi_{E_j} \rb_{j = 1}^\infty$ 为非负可测函数列, 用推论 \ref{col:Levi1}, 得
	\begin{align*}
		\int_E f = \int_E \dsum_{j = 1}^{\infty} f \chi_{E_j} = \dsum_{j = 1}^{\infty} \int_E f \chi_{E_j} = \dsum_{j = 1}^{\infty} \int_{E_j} f.
	\end{align*}
\end{Proof}

\begin{Corollary}
	设 $f \in L(E)$, $E = \dbigcup_{j = 1}^\infty E_j$, $\lb E_j \rb$ 两两不交的可测集列, 有 $\dint_E f = \dsum_{j = 1}^\infty \dint_{E_j} f$.
\end{Corollary}

\begin{Proof}
	记 $f = f^+ - f^-$. 由 $f \in L(E)$ 得 $f^+,~f^- \in L(E)$ 且非负, 则
	$$\int_E f = \int_E f^+ - \int_E f^- = \dsum_{j = 1}^{\infty} \int_{E_j} f^+ - \dsum_{j = 1}^{\infty} \int_{E_j} f^-.$$
	注意到 $\dsum_{j = 1}^{\infty} \dint_{E_j} f^+$, $\dsum_{j = 1}^{\infty} \dint_{E_j} f^-$ 是两个正项级数且分别收敛于 $\dint_E f^+$, $\dint_E f^-$. 故由收敛级数的性质, 得
	\begin{align*}
		\dsum_{j = 1}^{\infty} \int_{E_j} f^+ - \dsum_{j = 1}^{\infty} \int_{E_j} f^- = \dsum_{j = 1}^{\infty} \int_{E_j} \(f^+ - f^-\) = \dsum_{j = 1}^{\infty} \int_{E_j } f.
	\end{align*}
\end{Proof}

\begin{Theorem}[Fatou 引理]
	设 $\lb f_k \rb$ 是一个在 $E$ 上非负可测函数列, 则
	$$\int_E \liminf_{k \to \infty} f_k \leq \liminf_{k \to \infty} \int_E f_k.$$
\end{Theorem}

\begin{Proof}
	由 $\displaystyle\liminf_{k \to \infty} f_k = \dsup_k\dinf_{j \geq k} f_j$. 记 $g_k = \dinf_{j \geq k} f_j$. 因此 $\lb g_k \rb$ 非负可测, 且 $0 \leq g_k \nearrow \displaystyle\liminf_{k \to \infty} f_k$.
	由单调极限定理得
	$$\lim_{k \to \infty} \int_E g_k = \int_E \lim_{k \to \infty} g_k = \int_E \liminf_{k \to \infty} f_k.$$
	另一方面
	$$\lim_{k \to \infty} \int_E g_k = \lim_{k \to \infty} \int_E \inf_{j \geq k} f_j \leq \liminf_{k \to \infty} \int_E f_k.$$
	故
	\begin{align*}
		\int_E \liminf_{k \to \infty} f_k \leq \liminf_{k \to \infty} \int_E f_k.
	\end{align*}
\end{Proof}

\begin{Corollary}~
	\begin{enumerate}
		\item 设 $f \in L(E)$, $f_k$ 可测且几乎处处成立 $f_k \geq f$, 那么 $\dint_E \displaystyle\liminf_{k \to \infty} f_k \leq \displaystyle\liminf_{k \to \infty} \dint_E f_k.$
		\item 设 $g \in L(E)$, $g_k$ 可测且几乎处处成立 $g_k \leq g$, 那么 $\dint_E \displaystyle\limsup_{k \to \infty} g_k \geq \displaystyle\limsup_{k \to \infty} \dint_E g_k.$
	\end{enumerate}
\end{Corollary}

\begin{Proof}
(i) 令 $g_k = f_k - f, k \in \N_+$, $g_k$ 是在 $E$ 上几乎处处非负的可测函数列. 用 Fatou 引理
	$$\int_E \liminf_{k \to \infty} g_k \leq \liminf_{k \to \infty} \int_E g_k$$
	因为 $\(f_k - f\) + f = f_k$, 有 $\dint_E \(f_k - f\) + \dint_E f = \dint_E f_k$, $f$ 可积, 留作作业 (\textcolor{red}{?????不知道留作作业是什么}).
	$$\int_E g_k = \int_E \(f_k - f\) = \int_E f_k - \int_E f.$$
	因此
	$$\liminf_{k \to \infty} \int_E f_k - \int_E f = \liminf_{k \to \infty} \int_E g_k \geq \int_E \liminf_{k \to \infty} g_k = \int_E \(\liminf_{k \to \infty} f_k - f\) = \int_E \liminf_{k \to \infty} f_k - \int_E f.$$
	两端同加有限值 $\dint_E f$, 得
	\begin{align*}
		\int_E \liminf_{k \to \infty} f_k \leq \liminf_{k \to \infty} \int_E f_k.
	\end{align*}
\end{Proof}

\begin{Theorem}[Lebesgue 控制收敛定理]
	设 $\lb f_k \rb$ 在可测集 $E$ 上可测, 若存在 $g \in L(E)$ 使得
	\begin{enumerate}
		\item $|f_k| \leq g$, a.e. $x \in E$, \label{enu:con1}
		\item $\dlim_{k \to \infty} f_k(x) = f(x)$, a.e. $x \in E$. \label{enu:con2}
	\end{enumerate}
	则 $f \in L(E)$ 且 $\dlim_{k \to \infty} \dint_E f_k = \dint_E f$.
\end{Theorem}

\begin{Proof}~

	{\heiti 法一}:

	由条件 \eqref{enu:con1}, $-g \leq f_k \leq g$, $k \in \N_+$  及 Fatou 引理可得
	\begin{align*}
		\int_E \liminf_{k \to \infty} f_k &\leq \liminf_{k \to \infty} \int_E f_k,\\
		\int_E \limsup_{k \to \infty} f_k &\geq \limsup_{k \to \infty} \int_E f_k.
	\end{align*}
	又由条件 \eqref{enu:con2}, 不妨设 $\dlim_{k \to \infty} f_k(x) = f(x),~\forall x \in E$. 于是
	$$\int_E f \leq \liminf_{k \to \infty} \int_E f_k \leq \limsup_{k \to \infty} \int_E f_k \leq \int_E f.$$
	因此, $\dlim_{k \to \infty} \dint_E f_k$ 存在且等于 $\dint_E f$.

	由条件 \eqref{enu:con1}, $|f| = \dlim_{k \to \infty} |f_k| \leq g$ 及 $f$ 的可测性 (可测函数极限可测), 得到 $|f|$ 可测. 由 $g \in L(E)$ 可得 $|f| \in L(E)$. 因为 $f$ 可测, 所以 $f \in L(E)$.

	{\heiti 法二}:

	可用直接估值的方法证明.

	$|E| = \infty$ 时, 利用 \footnote{书上 68 页定理 3.6 的推论 2.}
	$$\lim_{r \to +\infty} \int_{E \cap B(0, r)} g = \int_E g.$$
	对任意的 $\ep > 0$, 存在 $r_0$ 使得 $r \geq r_0$ 时, 有
	$$0 \leq \int_E g < \int_{E \cap B(0 , r)} g + \ep.$$
	此时
	$$\int_{E \setminus E \cap B(0, r)} \lv f_k - f\rv \leq 2\int_{E \setminus E \cap B(0, r)} g < 2\ep.$$
	再由 $\lb f_k \rb$ 在 $E \cap B(0, r)$ 上几乎处处收敛于 $f$ 及 $|E \cap B(0, r)| < \infty$, 利用 Егоров 定理, 对任意的 $\delta > 0$, 都有 $E_0 \subset E \cap B(0, r)$ 可测且 $\lv E \cap B(0 , r) \setminus E_0\rv < \delta$. 且 $\lb f_k \rb$ 在 $E_0$ 上一致收敛.

	由 $g \in L(E)$, 对上述 $\ep > 0$, 利用积分的绝对连续性, 存在 $\delta = \delta(\ep) > 0$, 使得任意可测集 $F \subset E$, 只要 $|F| < \delta$ 就有 $\dint_F g < \ep$.

	对于对应 $\delta(\ep)$ 的 $E_0$, 由 $\lb f_k \rb$ 在 $E_0$ 的一致收敛性, 存在 $k_0 \in \N_+$, 使得当 $k \geq k_0$ 时, 有
	$$|f_k(x) - f(x)| < \frac{\ep}{|E_0| + 1},\quad \forall x \in E_0.$$
	因此, 当 $k \geq k_0$ 时, 有
	$$\int_E |f_k - f| = \int_{E_0} |f_k  - f| + \int_{E \cap B(0, r_0) \setminus E_0} |f_k - f| + \int_{E \setminus E \cap B(0, r_0)} |f_k - f| < \frac{\ep |E_0|}{|E_0| + 1} + \ep + 2\ep < 4\ep.$$

	$|E| < \infty$ 时, 上述证明中用 $E \cap B(0 , r_0)$ 代替 $E$ 即可.
\end{Proof}

\begin{Theorem}
	设 $g \in L(E)$, $|f_k| \leq g$, $k \in \N_+$. 若 $f_k \xra{m} f$, 则
$$\lim_{k \to \infty} \int_E f_k = \int_E f.$$
\end{Theorem}

\begin{Proof}\footnote{书上 76 页定理 3.14 的证明好像更简单些.}
	先说明 $f \in L(E)$.

	用 Riesz 定理, $f_k \xra{m} f$, 则 $\lb f_k \rb$ 有子列 $\lb f_{k_l} \rb$ 几乎处处收敛于 $f$. 再利用 $\lv f_{k_l}\rv \leq g$, $l \in \N_+$, 在 $x \in E$ 上几乎处处成立 $|f| \leq g$. 由 Lebesgue 控制收敛定理可得 $f \in L(E)$. 下证 $\dlim_{k \to \infty} \int_E f_k = \int_E f$, 只需证
	$$\liminf_{k \to \infty} \int_E f_k = \limsup_{k \to \infty} \int_E f_k = \int_E f.$$
	利用 $|f_k| \leq g$, 知
	$$\lv \int_E f_k \rv \leq \int_E |f_k| \leq \int_E g,\quad k \in \N_+.$$
	$\lb \dint_E f_k \rb$ 是一个有界数列, 故存在 $\lb \dint_E f_k \rb$ 的一个子列 $\lb \dint_E g_k \rb$, 使得
	$$\lim_{k \to \infty} \int_E g_k = \liminf_{k \to \infty} \int_E f_k.$$
	存在 $\lb \dint_E f_k \rb$ 的一个子列 $\lb \dint_E h_k \rb$, 使得
	$$\lim_{k \to \infty} \int_E h_k = \limsup_{k \to \infty} \int_E f_k.$$
	由 $f_k \xra{m} f$, 故 $g_k \xra{m} f$, 利用 Riesz 定理, 存在 $\lb g_k \rb$ 的子列 $\lb g_{k_j} \rb_{j = 1}^\infty$ 使得 $g_{k_j} \to f$. 又由 $\lv g_{k_j} \rv \leq g$, $j \in \N_+$, a.e. $x \in E$, 利用 Lebesgue 控制收敛定理, 有
	$$\int_E f = \lim_{j \to \infty} \int_E g_{k_j} = \lim_{k \to \infty} \int_E g_k = \liminf_{k \to \infty} \int_E f_k.$$
	同理, 取 $\lb h_k \rb$ 几乎处处收敛的子列 $\lb h_{k_j} \rb$,
	$$\int_E f = \lim_{j \to \infty} \int_E h_{k_j} = \lim_{k \to \infty} \int_E h_k = \limsup_{k \to \infty} \int_E f_k.$$
	故 $\dlim_{k \to \infty} \dint_E f_k$ 存在且等于 $\dint_E f$.
\end{Proof}

\begin{Theorem}[可微性]
设 $E$ 可测, $I$ 是一个开区间. 任意 $x \in I$, 若 $f(t, x)$ 作为 $t$ 的函数在 $E$ 上可积且
	$$\lv \dfrac{\pa f(t, x)}{\pa x} \rv \leq g(t),\quad t \in E,\quad x \in I,$$
其中 $g \in L(E)$, 则 $\dfrac{\di}{\di x} \dint_E f(t, x) \di t = \dint_E \dfrac{\pa f(t, x)}{\pa x} \di t.$
\end{Theorem}

\begin{Proof}
	提示: $x, x + \Delta x \in I$,
	\begin{align*}
		\frac{\dint_E f(t, x + \Delta x) \di t - \dint_E f(t, x) \di t}{\Delta x} &= \int_E \frac{\pa f(t, x + \theta \Delta x)}{\pa x} \di t,\quad \theta = \theta(t, x, \Delta x) \in (0, 1),\\
	\lim_{\Delta x \to 0} \int_E \frac{f(t, x + \Delta x) - f(t, x)}{\Delta x} \di t &= \lim_{k \to \infty} \int_E \frac{f(t, x + a_k) - f(t, x)}{a_k} \di t,
	\end{align*}
	其中 $\lb a_k \rb$ 是任何一个趋于 0 的非零数列.
\end{Proof}

\begin{Remark}
	先承认下述事实.
	\begin{enumerate}
	  \item $I$ 是有界矩形, $f$ 在 $I$ 上有界, 则 $f$ 在 $I$ 上 Riemann 可积可推出 Lebesgue 可积且积分值相等.
	  \item $I$ 是无界区间, $f$ 在 $I$ 上广义绝对 Riemann 可积可推出 Lebesgue 可积且积分值相等.
	\end{enumerate}
\end{Remark}

\begin{Example}
	将 $[0, 1]$ 中的有理数排成一列 $\lb r_k \rb$, 则 $\dsum_{k = 1}^{\infty} \dfrac{1}{2^k \sqrt{\lv x - r_k\rv}}$, $x \in [0, 1] \setminus \Q$ 在 $[0, 1]$ 几乎处处收敛.
\end{Example}

\begin{Proof}
	用 Levi 定理的推论可得
	$$\int_{[0, 1]} \dsum_{k = 1}^{\infty} \dfrac{1}{2^k \sqrt{\lv x - r_k\rv}} \di x = \dsum_{k = 1}^{\infty} \dfrac{1}{2^k} \int_{[0, 1]} \dfrac{1}{\sqrt{\lv x - r_k\rv}} \di x.$$
	又因为
	\begin{align*}
		\int_{[0, 1]} \dfrac{1}{\sqrt{\lv x - r_k\rv}} \di x &= \(\int_{[0, r_k)} + \int_{[r_k, 1]}\) \dfrac{1}{\sqrt{\lv x - r_k\rv}} \di x\\
		&= -2\left.\sqrt{r_k - x}\rv_0^{r_k} + 2 \left.\sqrt{x - r_k}\rv_{r_k}^1 = 2\sqrt{r_k} + 2 \sqrt{1 - r_k} \leq 4,
	\end{align*}
	所以 $\dint_{[0, 1]} \csum \dfrac{\di x}{2^k \sqrt{\lv x - r_k\rv}} \leq 4.$
\end{Proof}

\begin{Example}
	计算 $\dlim_{k \to \infty} \dint_0^1 \dfrac{kx^{\frac{1}{2}}\sin x}{1 + k^2x^2} \di x$.
\end{Example}

\begin{Solve}
	记 $f_k (x) = \dfrac{kx^{\frac{1}{2}}\sin x}{1 + k^2x^2}$, 有 $f(x) = \dlim_{k \to \infty} f_k (x) = 0$, $0 \leq x \leq 1$. 因为 $1 + k^2 x^2 \geq 2kx$, $0 \leq x \leq 1$, 所以
	$$f_k(x) \leq g(x) = \lb \begin{array}{ll}
		\dfrac{1}{2x^{\frac{1}{2}}}, & 0 < x \leq 1,\\
		0, & x = 0.
	\end{array}\right.$$
由 $g$ 在 $[0, 1]$ 上广义绝对 Riemann 可积可得 $g$ 在 $[0, 1]$ 上 Lebesgue 可积. 由 Lebesgue 控制收敛定理,
	\begin{align*}
		\lim_{k \to \infty} \dint_0^1 \dfrac{kx^{\frac{1}{2}}\sin x}{1 + k^2x^2} \di x = \dint_0^1 \lim_{k \to \infty} \dfrac{kx^{\frac{1}{2}}\sin x}{1 + k^2x^2} \di x = \int_{0}^{1} 0 \di x = 0.
	\end{align*}
\end{Solve}

\begin{Example}
	计算 $\dint_0^1 \dfrac{\ln (1 - x)}{x} \di x$.
\end{Example}

\begin{Solve}
	由 Taylor 级数,
	$$\ln (1 - x) = - \dsum_{k = 1}^{\infty} \dfrac{x^k}{k},\quad 0 \leq x < 1,\qquad \dfrac{\ln (1 - x)}{x} = - \dsum_{k = 1}^{\infty} \dfrac{x^{k - 1}}{k},\quad 0 < x < 1.$$
	由于 $\dfrac{x^{k - 1}}{k} \geq 0$, $x \in (0, 1]$, $\forall k \in \N_+$, 利用 Levi 定理推论
	\begin{align*}
		\int_0^1 \dfrac{\ln (1 - x)}{x} \di x = - \int_0^1 \dsum_{k = 1}^{\infty} \dfrac{x^{k - 1}}{k} \di x = - \dsum_{k = 1}^{\infty} \dfrac{1}{k^2} = - \dfrac{\pi^2}{6}.
	\end{align*}
\end{Solve}

%\begin{Example}
%	计算 $\dlim_{k \to \infty} \dint_0^{+\infty} \dfrac{\ln (k + x)}{k} \e^{-x} \cos kx \di x.$
%\end{Example}

%\begin{Solve}
%	记 $f_k(x) = \dfrac{\ln (k + x)}{k} \e^{-x} \cos kx, 0 \leq x \leq +\infty, k \in \N_+, f(x) = \dlim_{k \to \infty} f_k(x) = 0$. 因为
%	$$\lv \dfrac{\ln (k + x)}{k} \e^{-x} \cos kx \rv \leq \dfrac{\ln (k + x)}{k} \e^{-x} \leq (1 + x)\e^x, 0 \leq x \leq +\infty, \forall k \in \N_+.$$
%	注意到 $g(x) = (1 + x)\e^x \in L(0, +\infty)$, 利用 Lebesgue 控制收敛定理
%\end{Solve}

\section{把多重积分化为累次积分}

\begin{Theorem}[Tonelli 定理]
	设 $f$ 是 $\R^{m + n}$, $m,~n \in \N_+$ 上的非负可测函数, 那么成立等式
	\begin{equation}\label{equ:Tonelli}
		\iint_{\R^{m + n}} f(x, y) \di (x, y) = \int_{\R^m}\(\int_{\R^n} f(x, y) \di y\) \di x = \int_{\R^n}\(\int_{\R^m} f(x, y) \di x\) \di y.
	\end{equation}
\end{Theorem}

\begin{Proof}
	证明将按如下过程.
	$$\left.\begin{array}{r}
		\text{方块的特征函数} \Rightarrow \text{开集的特征函数}\\
		\text{零测集的特征函数}
	\end{array}\rb \Rightarrow \text{可测集的特征函数} \Rightarrow \text{简单函数列} \Rightarrow f~\text{非负可测}.$$

	(1) $f = \chi_{Q}$, $Q = [a, b] \times [c, d]$, $[a, b] \in \R^m$, $[c, d] \in \R^n$.
	\begin{align*}
		\iint_{\R^{m + n}} f(x, y) \di (x, y) &= \lv Q \rv_{m \times n} = \lv [a, b] \rv_m \lv [c, d] \rv_n = \int_{\R^n} \lv [a, b] \rv_m \chi_{[c, d]} (y) \di y\\
		&= \int_{\R^n} \(\int_{\R^m} \chi_{[a, b]}(x) \di x\) \chi_{[c, d]} (y) \di y = \int_{\R^n} \(\int_{\R^m} \chi_{[a, b]}(x) \chi_{[c, d]} (y) \di x\) \di y\\
		&= \int_{\R^n} \di y \int_{\R^m} f(x, y) \di x.
	\end{align*}
	同理
	$$\displaystyle\iint_{\R^{m + n}} f(x, y) \di (x, y) = \dint_{\R^m} \di x \dint_{\R^n} f(x, y) \di y.$$

	(2) $f = \chi_G$, $G$ 为开集. 由开集的半开区间分解定理知, 存在可数个左开右闭方块列 $\lb Q_k \rb_{k = 1}^\infty$, 使得 $G = \dbu_{k = 1}^\infty Q_k$, $Q_k$ 两两不交. 此时 $f(x, y) = \chi_G(x, y) = \dsum_{k = 1}^{\infty} \chi_{Q_k} (x, y)$, 则有
	$$\iint_{\R^{m + n}} f(x, y) \di (x, y) = \dsum_{k = 1}^{\infty} \iint_{\R^{m + n}} \chi_{Q_k} (x, y) \di (x, y).$$
	利用 (1),
	$$\iint_{\R^{m + n}} \chi_{Q_k} (x, y) \di (x, y) = \int_{\R^m} \di x \int_{\R^n} \chi_{Q_k} \di y.$$
	再用两次 Levi 定理, 有
	\begin{align*}
		\dsum_{k = 1}^{\infty} \iint_{\R^{m + n}} \chi_{Q_k} (x, y) \di (x, y) &= \int_{\R^m} \dsum_{k = 1}^{\infty} \(\int_{\R^n} \chi_{Q_k} \di y\) \di x = \int_{\R^m} \(\int_{\R^n} \dsum_{k = 1}^{\infty} \chi_{Q_k} \di y\) \di x\\
		&= \int_{\R^m} \(\int_{\R^n} f(x, y) \di y\) \di x.
	\end{align*}
	故
	$$\displaystyle\iint_{\R^{m + n}} f(x, y) \di (x, y) = \dint_{\R^m} \di x \dint_{\R^n} f(x, y) \di y,$$
	同理
	$$\displaystyle\iint_{\R^{m + n}} f(x, y) \di (x, y) = \dint_{\R^n} \di y \dint_{\R^m} f(x, y) \di x.$$

	(3) $f = \chi_E$, $E \subset \R^{m + n}$ 为可测集.

	(i) $|E|_{m + n} < \infty$ 时, 对于 $\ep_l = \dfrac{1}{l}$, $l \in \N_+$, 存在开集 $G_l \supset E$, 使得 $|G|_{m + n} < |E|_{m + n} + \ep_l$, 进而 $\lv \dbigcap_{l = 1}^\infty G_l \setminus E \rv = 0$. 记
	$$H = \dbigcap_{l = 1}^\infty G_l,\quad H_k = \dbigcap_{l = 1}^k G_l.$$
	$H_k$ 是开集且 $H_1 \supset H_2 \supset \cdots \supset H_k \supset \cdots$, 于是
	$$\chi_{H_k} \geq \chi_{H_{k + 1}} \geq \cdots,\quad \forall k \in \N_+,\qquad \dlim_{k \to \infty} \chi_{H_k} = \chi_H,\quad \chi_{H} \in L(\R^{m + n}).$$

	$|E|_{m + n} = 0$ 时, $0 \leq \chi_E \leq \chi_H$ 且
	$$\iint_{\R^{m + n}} \chi_H = \iint_{\R^{m + n}} \lim_{k \to \infty} \chi_{H_k} = \lim_{k \to \infty} \iint_{\R^{m + n}} \chi_{H_k} \xlongequal{(2)} \lim_{k \to \infty} \int_{\R^m} \di x \int_{\R^n} \chi_{H_k} (x, y) \di y.$$
	又有如下条件
	$$0 \leq \int_{\R^n}\chi_{H_{k + 1}} (x, y) \di y \leq \int_{\R^n} \chi_{H_{k}} (x, y) \di y \leq \int_{\R^n} \chi_{H_{1}} (x, y) \di y \in L(\R^m),$$
	故由 Lebesgue 控制收敛定理可得
	$$\iint_{\R^{m + n}} \chi_H = \lim_{k \to \infty} \int_{\R^m} \di x \int_{\R^n} \chi_{H_k} (x, y) \di y = \int_{\R^m} \(\lim_{k \to \infty} \int_{\R^n} \chi_{H_k} (x, y) \di y\) \di x.$$
	注意到
	$$\iint_{\R^{m + n}} \chi_H = |H|_{m + n} = |E|_{m + n} = 0,$$
	于是
	$$\lim_{k \to \infty} \int_{\R^n} \chi_{H_k} (x, y) \di y = 0,\quad \text{a.e.}~x \in \R^m.$$
	记 $Z_m \subset \R^m$, $\lv Z_m\rv_{m} = 0$ 使得
	$$\lim_{k \to \infty} \int_{\R^n} \chi_{H_k} (x, y) \di y = 0,\quad x \in \R^m \setminus Z_m.$$
	又
	$$\int_{\R^n} \chi_H (x, y) \di y = \int_{\R^n} \lim_{k \to \infty} \chi_{H_k} (x, y) \di y = \lim_{k \to \infty} \int_{\R^n} \chi_{H_k} (x, y) \di y = 0, \quad x \in \R^m \setminus Z_m,$$
	即任意的 $x \in \R^m \setminus Z_m$, $\chi_H(x, y)$ 作为 $y$ 的函数在 $\R^n$ 上几乎处处为 0.

	因此再由 $0 \leq \chi_E \leq \chi_H$, 知对于任意的 $x \in \R^m \setminus Z_m$ 作为 $y$ 的函数 $\chi_E(x, y)$ 在 $\R^n$ 上几乎处处为 0. 故 $\dint_{\R^n} \chi_E(x, y) \di y = 0$.
	进一步, $\dint_{\R^n} \chi_E (x, y) \di y$ 作为 $x$ 的函数几乎处处为 0.
	故
	$$\int_{\R^m} \di x \int_{\R^n} \chi_E (x, y) \di y = 0,$$
	且
	$$\iint_{\R^{m + n}} \chi_E = \int_{\R^m} \di x \int_{\R^n} \chi_E (x, y) \di y = 0.$$
	同理
	$$\iint_{\R^{m + n}} \chi_E = \int_{\R^n} \di y \int_{\R^m} \chi_E (x, y) \di x = 0.$$

	$|E|_{m + n} < \infty$ 时. $H = E \cup Z$, $E \cap Z = \varnothing$, $|Z|_{m + n} = 0$. 则
	$$\lim_{k \to \infty} \chi_{H_k} (x, y) = \chi_{H} (x, y) = \chi_{E} (x, y) + \chi_{Z} (x, y).$$
	所以
	\begin{align*}
		\iint_{\R^{m + n}} \chi_E &= \iint_{\R^{m + n}}\chi_{H} - \iint_{\R^{m + n}}\chi_{Z} = \lim_{k \to \infty} \iint_{\R^{m + n}}\chi_{H_k} - \iint_{\R^{m + n}}\chi_{Z}\\
		&= \lim_{k \to \infty} \int_{\R^{m}} \di x \int_{\R^n} \chi_{H_k} (x, y) \di y - \int_{\R^{m}} \di x \int_{\R^n} \chi_{Z} \di y,\\
		\text{(Lebesgue 控制收敛定理)}\quad&=\int_{\R^m}\(\lim_{k \to \infty} \int_{\R^n} \chi_{H_k} (x, y) \di y\)\di x - \int_{\R^{m}} \di x \int_{\R^n} \chi_{Z} \di y,\\
		\text{(Lebesgue 控制收敛定理)}\quad&=\int_{\R^m}\( \int_{\R^n} \lim_{k \to \infty} \chi_{H_k} (x, y) \di y\)\di x - \int_{\R^{m}} \di x \int_{\R^n} \chi_{Z} \di y,\\
		&= \int_{\R^m} \(\int_{\R^n} \chi_{H} (x, y) \di y - \int_{\R^n} \chi_{Z} (x, y) \di y\)\di x\\
		&= \int_{\R^m} \(\int_{\R^n} \(\chi_{H} (x, y) \di y - \chi_{Z} (x, y) \di y\)\) \di x = \int_{\R^m} \(\int_{\R^n} \chi_E(x, y)\di y\)\di x.
	\end{align*}
	同理
	$$\iint_{\R^{m + n}} \chi_{E} = \int_{\R^n} \(\int_{\R^m} \chi_E(x, y)\di x\)\di y.$$

	(ii) $|E|_{m + n} = \infty$ 时, 有
	$$E = \dbigcup_{j = 1}^\infty E_j,\quad |E_j|_{m + n} < \infty,\quad j\in \N_+,\quad \chi_E(x, y) = \dsum_{j = 1}^\infty \chi_{E_j} (x, y),$$
	其中 $\lb E_j \rb$ 两两不交且可测. 用 Levi 定理, 有
	\begin{align*}
		\iint_{\R^{m + n}} \chi_{E} &= \dsum_{j = 1}^\infty \iint_{\R^{m + n}} \chi_{E_j} = \dsum_{j = 1}^\infty \int_{\R^m} \(\int_{\R^n} \chi_{E_j} (x, y) \di y\) \di x\\
		&= \int_{\R^m} \(\dsum_{j = 1}^\infty \int_{\R^n} \chi_{E_j} (x, y) \di y\) \di x = \int_{\R^m} \(\int_{\R^n}\(\dsum_{j = 1}^\infty \chi_{E_j} (x, y)\) \di y\) \di x\\
		&= \int_{\R^m} \(\int_{\R^n} \chi_{E} (x, y) \di y\) \di x.
	\end{align*}
	同理
	$$\iint_{\R^{m + n}} \chi_{E} = \int_{\R^n} \(\int_{\R^m} \chi_E(x, y)\di x\)\di y.$$

	(4) 设 $f = \dsum_{j = 1}^{k} c_j \chi_{E_j} (x, y)$, 其中 $E_1, \cdots, E_k$ 可测且两两不交, $c_j \geq 0$, $j = 1, \cdots, k$. 则有
	\begin{align*}
		\iint_{\R^{m + n}} f &= \dsum_{j = 1}^{k} c_j |E_j|_{m + n} = \dsum_{j = 1}^{k} c_j \iint_{\R^{m + n}} \chi_{E_j} \xlongequal{(3)} \dsum_{j = 1}^{k} c_j \int_{\R^m}\(\int_{\R^n} \chi_{E_j} (x, y) \di y\) \di x\\
		&\xlongequal{\text{运算性质}} \int_{\R^m} \(\dsum_{j = 1}^{k} c_j \int_{\R^n} \chi_{E_j} (x, y) \di y\)\di x = \int_{\R^m} \(\int_{\R^n} \dsum_{j = 1}^{k} c_j \chi_{E_j} (x, y) \di y\)\di x\\
		&= \int_{\R^m} \(\int_{\R^n} f(x, y) \di y\)\di x.
	\end{align*}
	同理
	$$\iint_{\R^{m + n}} \chi_{E} = \int_{\R^n} \(\int_{\R^m} \chi_E(x, y)\di x\)\di y.$$

	(5) 设 $f$ 在 $\R^{m + n}$ 中非负可测的, 利用定理 \ref{thm:fNotNegative}, 存在非负简单函数列 $\lb \p_k \rb$ 满足
	$$0 \leq \p_1 \leq \cdots \leq \p_k \leq \cdots,\quad \lim_{k \to \infty} \p_k = f.$$
	利用 Levi 定理, 有
	\begin{align*}
		\iint_{\R^{m + n}} f &= \lim_{k \to \infty} \iint_{\R^{m + n}} \p_k = \lim_{k \to \infty} \int_{\R^m} \di x \int_{\R^n} \p_k(x, y) \di y\\
		&= \int_{\R^m} \di x \lim_{k \to \infty}\int_{\R^n} \p_k(x, y) \di y = \int_{\R^m} \di x \int_{\R^n} \lim_{k \to \infty} \p_k(x, y) \di y\\
		&= \int_{\R^m} \di x \int_{\R^n} f(x, y) \di y.
	\end{align*}
	同理
	\begin{align*}
		\iint_{\R^{m + n}} f = \int_{\R^n} \di y \int_{\R^m} f(x, y) \di x.
	\end{align*}
\end{Proof}

\begin{Theorem}[Fubini 定理]
	设 $f \in L(\R^{m + n})$, 那么 \eqref{equ:Tonelli} 式对于 $f$ 成立.
\end{Theorem}

\begin{Proof}
	将 $f$ 写成 $f = f^+ - f^-$, 其中 $f^+, f^-$ 分别是 $f$ 的正部和负部. 则
	\begin{align*}
		\iint_{\R^{m + n}} f &= \iint_{\R^{m + n}} f^+ - \iint_{\R^{m + n}} f^- \xlongequal{\text{定理}~3.15} \int_{\R^m} \di x \int_{\R^n} f^+(x, y) \di y - \int_{\R^m} \di x \int_{\R^n} f^-(x, y) \di y\\
		&= \int_{\R^m} \di x \(\int_{\R^n} f^+(x, y) \di y - \int_{\R^n} f^-(x, y) \di y\) = \int_{\R^m} \di x \int_{\R^n} \(f^+(x, y) - f^-(x, y)\) \di y\\
		&= \int_{\R^m} \di x \int_{\R^n} f(x, y) \di y.
	\end{align*}
	同理
	\begin{align*}
		\iint_{\R^{m + n}} f = \int_{\R^n} \di y \int_{\R^m} f(x, y) \di x.
	\end{align*}
\end{Proof}

\section{Riemann 积分与 Lebesgue 积分关系}

\begin{Definition}
	$f$ 在 $E$ 上相对于 $E$ 连续, 等价于任意 $x \in E$, $\ep > 0$, 存在 $\delta > 0$, 只要 $y \in E$ 且 $|x - y| < \delta$ 时, 就有 $|f(x) - f(y)| < \ep$.
\end{Definition}

\begin{Example}
	Dirichlet 函数 $f$, $f|_\Q$ 相对于 $\Q$ 连续, $f|_{\R\setminus\Q}$ 相对于 $\R\setminus\Q$ 连续.
\end{Example}

\begin{Theorem}
	$\Rie(D) \subset L(D)$, 其中 $D$ 是 $\R^n$ 中的矩形.
\end{Theorem}

\begin{Proof}
	先证任意 $f \in \Rie(D)$, $f$ 都可测. 由 $f \in \Rie(D)$ 的性质, $f$ 在 $D$ 上有界且几乎处处连续. 即存在零测集 $E_0 \subset D$, $\forall x \in D \setminus E_0$ 都是 $f$ 相对于 $D$ 的连续点, 也是 $f$ 相对于 $D \setminus E_0$ 的连续点. 由命题 \ref{pro:ContMear}, 知 $f$ 在 $D \setminus E_0$ 上可测. 因为 $E_0$ 为零测集, 所以 $f$ 在 $E_0$ 上可测. 故 $f$ 在 $D = (D \setminus E_0) \cup E_0$ 上可测.

	再利用 $f$ 的有界性, 即存在 $M > 0$, 使得 $|f(x)| \leq M$. 因为 $D$ 是长方体, $|D| < \infty$, 所以 $M$ 作为一个常函数在 $D$ 上 Lebesgue 可积. 又有 $f$ 可测, 因此 $|f| \in L(D)$ 可以推出 $f \in L(D)$.
\end{Proof}

\begin{Theorem}\label{thm:RieLeb}
	设 $f \in \Rie(D)$ 则
	$$(R) \int_D f(x) \di x = (L) \int_D f,$$
	其中, $(R) \dint_D f(x)$ 表示 $f$ 的 Riemann 积分, $(L) \dint_D f$ 表示 $f$ 的 Lebesgue 积分.
\end{Theorem}

证明之前回忆 Riemann 积分定义. 将 $D$ 分成有限个闭长方块
$$\D_1, \D_2, \cdots, \D_k,\quad \dbu_{l = 1}^k \D_l = D,\quad i \neq j,\quad \mathring{\D}_i \cap \mathring{\D}_j \neq \varnothing.$$
任取 $\xi_l \in \D_l$, $l = 1, 2, \cdots, k$, 若存在 $I \in \R$ 使得当 $\lambda := \dmax_{1 \leq l \leq k} (\diam \D_l) \to 0$ 时, $\dsum_{l = 1}^{k} f(\xi_l) |\D_l|$ 有极限 $I$, 则称 $f$ 在 $D$ 上 Riemann 可积. $I$ 是 $f$ 在 $D$ 上的积分, 记 $I =: (R) \dint_D f$. 有如下结论.
\begin{enumerate}
	\item $f \in \Rie(D) \Rightarrow f$ 有界.
	\item $S(f) := \dsum_{l = 1}^k M_l |\D_l|$, $s(f) := \dsum_{l = 1}^k m_l |\D_l|$, 其中 $M_l := \dsup_{x \in \D_l} f(x)$, $m_l := \dinf_{x \in \D_l} f(x)$, 有
	$$f \in \Rie(D)\quad \Rightarrow\quad \lim_{\lambda \to 0} (S(f) - s(f)) = 0.$$

	\item 分划加细 (略).
\end{enumerate}

下面证明定理 \ref{thm:RieLeb}.
\begin{Proof}
	取 $D$ 的一列分划 $T_k = \lb \D_{1k}, \cdots, \D_{N_k k} \rb,$ 其中 $\D_{jk}$, $j = 1, 2, \cdots, N_k$ 是闭长方块, $D = \dbu_{j = 1}^{N_k} \D_{jk}$, 且 $\mathring{\D}_{jk} \cap \mathring{\D}_{ik} = \varnothing$, $i \neq j$. 对每个 $k$, $T_{k + 1}$ 是 $T_k$ 的加细. 此时有
	\begin{equation}\label{equ:RieLeb}
		S\(f, T_{k + 1}\) \leq S\(f, T_{k}\),\quad s\(f, T_{k + 1}\) \geq s\(f, T_{k}\),\qquad \dlim_{k \to \infty} (S(f, T_k) - s(f, T_k)) = 0.
	\end{equation}
	定义
	\begin{equation}\label{equ:RieLeb2}
		f^+_{T_k} (a) = \dsum_{l = 1}^{N_k} M_{lk} \chi_{\D_{lk}}(x),\quad f^-_{T_k} (a) = \dsum_{l = 1}^{N_k} m_{lk} \chi_{\D_{lk}}(x),
	\end{equation}
	其中 $M_{lk} = \dsup_{x \in \D_{lk}} f(x)$, $m_{lk} = \dinf_{x \in \D_{lk}} f(x)$. 则有
	$$\int_{D} f^+_{T_k} = S(f, T_k),\quad \int_{D} f^-_{T_k} = s(f, T_k),\quad f^+_{T_k} \geq f^+_{T_{k + 1}},\quad f^-_{T_k} \leq f^-_{T_{k + 1}},\quad\text{a.e.}~x \in E,\quad \forall k \in\N_+.$$
	事实上记 $E = \dbu_{k = 1}^\infty \dbu_{l = 1}^\infty \pa \D_{lk}$, 则 $|E| = 0$. 任意 $x \in D \setminus E$, 都有 $x \in \mathring{\D}_{lk}, x \in \mathring{\D}_{l, k + 1}$. 再由 $T_{k + 1}$ 是 $T_k$ 的加细, 则
	$$f^+_{T_{k + 1}} (x) = M_{l', k + 1} \leq M_{lk} =f^+_{T_{k}} (x),$$
	同理 $f^-_{T_{k + 1}} (x) \geq f^-_{T_{k}} (x)$. 再由
	$$f^-_{T_{k}}(x) \leq f(x) \leq f^+_{T_{k}}(x),\quad \forall k \in \N_+,$$
	可得
	$$\lim_{k \to \infty} f^-_{T_{k}}(x) \leq f(x) \leq \lim_{k \to \infty} f^+_{T_{k}}(x), x \in D \setminus E.$$
	由 \eqref{equ:RieLeb}, \eqref{equ:RieLeb2} 式可得
	$$\int_D(f^+_{T_{k}}(x) - f^-_{T_{k}}(x)) \di x = S(f, T_k) - s(f, T_k) \to 0,\quad k \to \infty,$$
	即
	$$\int_D\(\lim_{k \to \infty} f^+_{T_{k}}(x) - \lim_{k \to \infty} f^-_{T_{k}}(x)\) \di x = 0.$$
	进而
	$$\lim_{k \to \infty} f^-_{T_{k}}(x) = f(x) = \lim_{k \to \infty} f^+_{T_{k}}(x),\quad \text{a.e.}~x \in D \setminus E,$$
	所以
	\begin{align*}
		(R)\int_D f(x) \di x = \lim_{k \to \infty} S(f, k) = \lim_{k \to \infty} (R) \int_D f^+_{T_{k}}(x) \di x = \lim_{k \to \infty} (L) \int_D f^+_{T_{k}}(x) \di x = (L) \int_D f(x) \di x.
	\end{align*}
\end{Proof}

\begin{Theorem}
	无界区域上的广义 Riemann 可积函数为 Lebesgue 可积函数的充要条件是它为广义绝对 Riemann 可积函数.
\end{Theorem}

\begin{Proof}
	为了简明, 只证一元且区间为 $[a, +\infty)$ 的情形.

	设 $f$ 在 $[a, +\infty) \subset \R$ 上广义 Riemann 可积, 则 $f \in L\([a, +\infty)\)$ 可以推出 $|f|$ 在 $[a, +\infty)$ 上广义 Riemann 可积. 下证充分性. 由定理 \ref{thm:RieLeb} 可得
	$$(R) \int_{a}^{k} |f(x)| \di x = (L) \int_{a}^{k} |f(x)| \di x,\quad \forall k \geq a.$$
	令 $k \to +\infty$, 有
	\begin{align*}
		(R) \int_{a}^{+\infty} |f(x)| \di x = \lim_{k \to +\infty} (R) \int_{a}^{k} |f(x)| \di x &= \lim_{k \to +\infty} (L) \int_{a}^{k} |f(x)| \di x = \lim_{k \to +\infty} (L) \int_{a}^{+\infty} |f(x)|\chi_{[a, k]}(x) \di x\\
		\(\lb |f(x)|\chi_{[a, k]} \rb~\text{是增列}\)\quad &= (L) \int_{a}^{+\infty} \lim_{k \to +\infty} |f(x)|\chi_{[a, k]}(x) \di x = (L) \int_{a}^{+\infty} |f| < +\infty.
	\end{align*}
	因此 $f \in L\([a, +\infty)\)$.
\end{Proof}

\section{Lebesgue 积分小结}

\begin{itemize}
	\item 积分定义
	\begin{itemize}
		\item 非负简单函数
		\item 非负可测函数
		\item 一般可测函数
	\end{itemize}

	\item 性质
	\begin{itemize}
		\item $L(E)$ 是线性空间
		\item 绝对连续性
		\item 单调性
	\end{itemize}

	\item 积分号下取极限
	\begin{itemize}
		\item 基本引理
		\item 单调收敛定理
		\item Fatou 引理
		\item Lebesgue 控制收敛定理
	\end{itemize}

	\item (广义) Riemann 可积与 Lebesgue 可积

	\item 把重积分化为累次积分
\end{itemize}

\chapter{一元函数的变化性态}

\begin{itemize}
	\item 定义域: 区间
	\item 单调函数可微性
	\item 单调函数导数在区间可积
	\item 有界变差函数
	\item 绝对连续函数
\end{itemize}

\section{单调函数可微性}	% \S 4.1

\begin{Theorem}	%[定理 1.1]
	设 $f$ 在 $[a, b] \subset \R$ 上单调, 则 $f$ 在 $[a, b]$ 上几乎处处可微 (可导), 且
	$$\dint_{[a, b]} |f'| \leq |f(a) - f(b)|.$$
\end{Theorem}

\begin{Remark}
	当 $f$ 在 $[a, b]$ 上单调不减, 此时 $[a, b]$ 上几乎处处有 $f'(x) \geq 0$, 且 $\dint_{[a, b]} f'(x)\di x \leq f(b) - f(a)$. 当 $f$ 在 $[a, b]$ 上单调不增, 此时 $[a, b]$ 上几乎处处有 $f'(x) \leq 0$. 由 $-f$ 单调不减可得
	$$- \int_{[a, b]} f'(x) \di x = \int_{[a, b]} (-f)'(x) \di x \leq (-f)(b) - (-f)(a) = -(f(b) - f(a)),$$
	进而 $\dint_{[a, b]} f'(x)\di x \geq f(b) - f(a)$.
\end{Remark}

\begin{Proof}
	设 $f$ 单调不减. 第一步证明 $f$ 在 $[a, b]$ 上几乎处处可导, 第二步证明 $\dint_{[a, b]} f'(x) \di x \leq f(b) - f(a)$.

	第一步比较复杂, 先证第二步, $f$ 的可微性质后面再证. 设 $f$ 在 $[a, b]$ 上单调不减, 在 $f$ 几乎处处可微已知的情况下, 下证 $\dint_{[a, b]} f'(x) \di x \leq f(b) - f(a)$. 不妨设任意 $x > b$ 都有 $f(x) = f(b)$ 及
	$$F_k(x) = k\( f(x + k^{-1}) - f(x) \),\quad x \in [a, +\infty).$$
	则由承认的事实知
	$$\lim_{k \to \infty} F_k(x) = f'(x),\quad \text{a.e.}~x \in [a, +\infty).$$
	由 Fatou 引理及 $F_k$, $k \in \N_+$ 的可测性 (可测函数线性组合, 极限仍是可测函数) 得
	\begin{align*}
		\int_{[a, b]} f'(x) \di x &= \int_{[a, b]} \lim_{k \to \infty} F_k(x) \di x = \int_{[a, b]} \liminf_{k \to \infty} F_k(x) \di x \leq \liminf_{k \to \infty} \int_{[a, b]} F_k(x) \di x\\
		&= \liminf_{k \to \infty} k\( \int_{a}^{b} f(x + k^{-1}) \di x - \int_{a}^{b} f(x) \di x \) = \liminf_{k \to \infty} k \( \int_{a + k^{-1}}^{b + k^{-1}} f(x) \di x - \int_{a}^{b} f(x) \di x \)\\
		&= \liminf_{k \to \infty} k\( \int_{b}^{b + k^{-1}} f(x) \di x - \int_{a}^{a + k^{-1}} f(x) \di x \) \leq f(b) - f(a),
	\end{align*}
	其中最后一个不等式用到 $f(x) \geq f(a), \forall x \geq a$.
\end{Proof}

\begin{Remark}
	$\dint_{[a, b]} f' \leq f(b) - f(a)$ 中的不等号有时是严格的, 即存在增函数 $f$, 使得 $\dint_{[a, b]} f' < f(b) - f(a)$.
\end{Remark}

\begin{Remark}
	书上 127 页定义 1.1, 1.2 注意区分左右导数及导数左右极限.
\end{Remark}

\begin{Example}
	$$f(x) = \lb\begin{array}{ll}
	x^2 \sin\(\dfrac{1}{x}\), & x \neq 0,\\
	0, & x = 0.
	\end{array}\right.$$
	$f'(x + 0)$, $f'(x - 0)$ 不存在但左右导数 $f'_+(x), f'_-(x)$ 存在.
\end{Example}

\begin{Definition}[数分中的覆盖]
	$E \subset \R$, $\mathscr{F} = \lb G: G \subset \R ~\text{是开集} \rb$. 若任意 $x \in E$, 存在 $G \in \mathscr{F}$ 使得 $x \in G$, 则称 $\scr{F}$ 是 $E$ 的一个开覆盖.
\end{Definition}

\begin{Definition}[Vitali 覆盖]
	设 $E \subset \R^n$, $\mathscr{A}$ 是一族直径大于零的方块. 若任意 $x \in E$, $\delta > 0$,  存在 $Q \in \mathscr{A}$, 使得 $x \in Q$ 且 $\diam (Q) < \delta$, 那么就称 $\scr{A}$ 是 $E$ 的 Vitali 覆盖.
\end{Definition}

\begin{Example}
	令 $\mathscr{A} = \lb \( \dfrac{1}{k}, 1 + \dfrac{1}{k} \) \rb, k \in \N_+$, 有 $(0, 1] \subset \dbu_{k = 1}^\infty \( \dfrac{1}{k}, 1 + \dfrac{1}{k} \)$, 但 $\mathscr{A}$ 不是 Vitali 覆盖.
\end{Example}

\begin{Example}
	令
	$$\mathscr{A} = \lb \( x, x + \dfrac{1}{k} \), k \in \N_+, x \in (0, 1] \rb,$$
	则 $\mathscr{A}$ 是 $(0, 1]$ 的一个 Vitali 覆盖. 事实上, 任意 $x \in (0, 1]$, $\delta > 0$, 存在 $k$, 使得 $x \in \left[x, x + \dfrac{1}{k}\)$ 且 $\dfrac{1}{k} < \delta$.
\end{Example}

\begin{Lemma}[Vitali 覆盖引理]\footnote{我上课没听懂 Vitali 覆盖引理以及用 Vitali 引理证明单调函数几乎处处可微的证明, 所以证明参见课本.}
	设 $E \subset \R^n$, $\scr{Q}$ 是 $E$ 的 Vitali 覆盖, 则 $\scr{Q}$ 中存在至多可数个两两不交的元素 $Q_k$, $k \in \N_+$ (角标 $k$ 不必跑满 $\N_+$), 使得
	$$\lv E \setminus \dbu_k Q_k \rv = 0,\quad \forall m \in \N_+,\quad E \setminus \dbu_k\ol{Q}_k \subset \dbu_{k \geq m} Q'_k,$$
	其中 $Q'_k$ 是 $Q_k$ 的同心 $4$ 倍扩大 (如果不存在 $Q_k$ 满足 $k \geq m$, 则视 $\dbu_{k \geq m} Q'_k$ 为空集).
\end{Lemma}

%\begin{Proof}[Vitali 覆盖引理]
%	分两步.
%	\begin{enumerate}
%	  \item 当 $E$ 有界时.
%	  \item 当 $E$ 无界时.
%	$E = \dbu_{k = 1}^\infty E_k \cup E_0, |E_0| = 0, E_k$ 有界 (不一定可测), $k \in \N_+$.
%	\begin{align*}
%		G_k &= (-k, k)^n, k = 1, 2, \cdots &
%		A_k &= \(G_{k + 1} \setminus G_k\)^\circ, k = 1, 2, \cdots\\
%		A_1 &= G_1, &
%		\R^n &= \dbu_{k = 1}^\infty A_k \cup \dbu_{k = 1}^\infty \pa G_k,\\
%		&\Rightarrow E_k= A_k \cap E,\quad \lb E_k \rb~\text{两两不交}.
%	\end{align*}
%	\end{enumerate}

%	{\zihao{-2} 这部分上课没听懂, 还是看书吧.}
	%(i) $E$ 有界时, 取开集 $G \supset E$.
%	$$\mathscr{Q}_1 = \lb Q \in \scr{Q} : Q \subset G \rb.$$
%	$\scr{Q}_1$ 是 $E$ 的一个 Vatali 覆盖.
%	%$\forall x \in E \subset G, \exists$ 开方块, $Q^* \subset G$, $x$ 是 $Q^*$ 的中心. 因 $\scr{Q}$ 是 $E$ 的一个 Vatali 覆盖. $\forall \delta > 0, \exists Q \in \scr{Q}, Q \ni x$ 且
%	$+\infty > d_1 = \sup\lb \diam Q : Q \in \scr{Q}_1 \rb.$
%
%	取 $Q_1 \in \scr{Q}_1, \diam Q_1 > \dfrac{3}{4}d_1.$ 若 $\overline{Q}_1 \supset E$ 则已证. 否则
%	$$\mathscr{Q}_2 = \lb Q \in \scr{Q}_1 : Q \cap Q_1 = \varnothing \rb, d_2 = \sup\lb \diam Q : Q \in \scr{Q}_2 \rb.$$
%	$\exists Q_2 \in \scr{Q}_2$ 使得 $\diam Q_2 > \dfrac{3}{4} d_2$. 若 $\overline{Q}_1 \cup \overline{Q}_2$ 则已证. 否则 $\cdots$
%
%	一般取出 $Q_1, Q_2, \cdots, Q_k \in \scr{Q}$ 两两不交. 若 $\overline{Q}_1 \cup \cdots \cup \overline{Q}_k \supset E$ 则已证. 否则
%	$$\mathscr{Q}_{k + 1} = \lb Q \in \scr{Q}_1 : Q \cap Q_1 = \varnothing \rb, d_2 = \sup\lb \diam Q : Q \in \scr{Q}_2 \rb.$$~
%\end{Proof}

%\begin{Proof}[用 Vitali 引理证明单调函数几乎处处可微]
%	{\zihao{-2} 这里也是.}
%\end{Proof}

\begin{Definition}[函数上下极限]
	设 $\p : (a, b) \to \R$, 下极限定义为
	$$\liminf_{h \to 0+} \p(h) := \lim_{h \to 0+} \inf_{x < t < x + h} \p(t),$$
	上极限可类似地定义.
\end{Definition}

显然有如下等价关系.
	\begin{align*}
		&\liminf_{h \to 0+} \p(h) = \lim_{h \to 0+} \inf_{x < t < x + h} \p(t) < \lambda,\\
		\Longleftrightarrow\quad & \exists \delta > 0,~\text{使}~h \in (0, \delta)~\text{时}, \inf_{x < t < x + h} \p(t) < \lambda,\\
		\Longleftrightarrow\quad & \exists \delta > 0,~\text{对}~\forall h \in (0, \delta)~\text{都有}~t \in (x, x + h)~\text{使得}~\p(t) < \lambda,\\
		\Longleftrightarrow\quad & \exists \delta > 0,~\exists t_k \in (x, x + \delta),~k = 1, 2, \cdots,~ t_k \to x+,~k \to \infty,~\p(t_k) < \lambda.
	\end{align*}

\begin{Proof}
	下证书上 128 页定理 1.1 的证明中, 集
	$$E_{uv} = \lb x \in (a, b) : D_- f(x) < u < v < D^+ f(x) \rb$$
	为零测集, 分两步.

	第一步.
	$$E_u = \lb x \in (a, b) : D_- f(x) < u \rb \supset E_{uv}.$$
	任意 $x \in E_u$, 有
	\begin{align*}
		& \liminf_{h \to 0+} \dfrac{f(x) - f(x - h)}{h} < u\\
		\Longleftrightarrow\quad  & \exists \delta > 0,~\forall h \in (0, \delta),~\exists t \in (0, h)~\text{使}~\dfrac{f(x) - f(x - t)}{t} < u.
	\end{align*}
	令
	\begin{equation}\label{equ:scrFu}
		\scr{F}_u = \lb [t, s] \subset (a, b) : f(s) - f(t) < u(s - t) \rb,
	\end{equation}
	则 $\scr{F}_u$ 是 $E_u$ 的一个 Vitali 覆盖, 也是 $E_{uv}$ 的一个 Vitali 覆盖. 由 Vitali 覆盖引理, 存在一族至多可数的区间 $I_k \in \scr{F}_u$ 两两不交, 使得 $\lv E_{uv} \setminus \dbu_k I_k \rv = 0$. 记 $\mathring{I}_k = (a_k, b_k), A_k = \mathring{I}_k \cap E_{uv}$, $k = 1, 2, \cdots$. 若 $A_k \neq \varnothing$, $\forall x \in A_k$, 则
	\begin{align*}
		& D^+ f(x) = \limsup_{h \to 0+} \dfrac{f(x + h) - f(x)}{h} > v\\
		\Longleftrightarrow\quad  & \exists \delta > 0,~\forall h \in (0, \delta),~\exists t \in (a, b)~\text{使}~\dfrac{f(x + t) - f(x)}{t} > v.
	\end{align*}
	令 $$\scr{F}^*_{vk} = \lb [t, s] \subset	 \mathring{I}_k : f(s) - f(t) > v(s - t) \rb.$$
	$\scr{F}^*_{vk}$ 是 $A_k$ 的一个 Vitali 覆盖. 由 Vitali 覆盖引理, 存在一族至多可数的区间 $J_{kl} \in \scr{F}^*_{vk}$ 两两不交, 使得 $\lv A_k \setminus \dbu_l J_{kl} \rv = 0$. 利用 $f$ 的单增性, 记 $J_{kl} = [a_{kl}, b_{kl}]$, $l \in N_k \subset \N_+$, $N_k$ 是有限集或 $\N_+$, $J_{kl} \subset\mathring{I}_k$, 有
	$$f(b_k) - f(a_k) \geq \dsum_{l \in N_k} \(f(b_{kl}) - f(a_{kl})\).$$
	又 $f(b_{kl}) - f(a_{kl}) > v (b_{kl} - a_{kl}), \forall l \in N_k$, 故
	$$\begin{array}{c}f(b_k) - f(a_k) > v \dsum_{l \in N_k} (b_{kl} - a_{kl}) = v \dsum_{l \in N_k} |J_{kl}| \geq v |A_k|,\\
	A_k = \mathring{I}_k \cap E_{uv} = \(\mr{I}_k \cap E_{uv} \setminus \(\dbu_{l \in N_k} J_{kl} \cap E_{uv}\)\) \cup \(\dbu_{ l \in N_k} J_{kl} \cap E_{uv}\).\end{array}$$
	任意 $\ep > 0$, 取开集 \footnote{这个 $G$ 能取到好像不是那么显然, 应该要对 \eqref{equ:scrFu} 式中集合包含于 $G$ 做些说明.} $G \supset E_{uv}$, 使得 $I_k \subset G$ 且 $|G| \leq |E_{uv}| + \ep$, 有
	\begin{align*}
		v|E_{uv}| &\leq v \lv \dbu_k \(\mr{I}_k \cap E_{uv}\) \rv = v \lv\dbu_k A_k \rv \leq v \dsum_{k} |A_k| \\
		&< \dsum_{k} \(f(b_k) - f(a_k)\) < \dsum_{k} u (b_k - a_k) = u \dsum_{k}|I_k| \leq u |G| < u\(|E_{uv}| + \ep\),
	\end{align*}
	即 $v |E_{uv}| < u \(|E_{uv}| + \ep\)$. 由 $\ep$ 的任意性, $v|E_{uv}| \leq u|E_{uv}|$. 因为 $u < v$, 所以 $|E_{uv}| = 0$.
\end{Proof}

\begin{Theorem}[Fubini 逐项求导定理]
	设 $f_k : [a, b] \to \R$ 单调不减, 若任意的 $x \in [a, b]$, $\dsum_{k = 1}^\infty f_k (x)$ 收敛于 $f(x)$, 则几乎所有的 $x \in [a, b]$, 有 $f'(x) = \dsum_{k = 1}^\infty f'_k(x)$.
\end{Theorem}

\begin{Proof}
	记 $r_n(x) = \dsum_{k = n + 1}^\infty f_k(x)$, $n \in \N_+$. 因 $f_k$ 单调不减, 故存在 $f'_k(x)$,~a.e.~$x \in [a, b]$ 且 $f'_k(x) \geq 0$, 有
	$$0 \leq \dint_{a}^{b} f'_k(x) \di x \leq f_k(b) - f_k(a),\quad \forall k \in \N_+,$$
	于是
	$$\dint_{a}^{b} \dsum_{k = n + 1}^{\infty} f'_k(x) \di x \xle{\text{Levi 定理}} \dsum_{k = n + 1}^{\infty} \int_{a}^{b} f'_k(x) \di x \leq \dsum_{k = n + 1}^{\infty} \(f_k(b) - f_k(a)\) \to 0,\quad n \to \infty.$$
	又
	$$\begin{array}{c}
		\dsum_{k = n + 1}^{\infty} f'_k(x) \geq \dsum_{k = n + 2}^{\infty} f'_k(x),\quad \forall n \in \N_+,\\
		\dlim_{n \to \infty} \dint_{a}^{b} \dsum_{k = n + 1}^{\infty} f'_k(x) \di x = \int_{a}^{b} \lim_{n \to \infty} \dsum_{k = n + 1}^{\infty} f'_k(x) \di x = 0,
	\end{array}$$
	故
	$$\dsum_{k = n + 1}^{\infty} f'_k(x) \di x \to 0,\quad \text{a.e.}~x \in [a, b],\quad n \to \infty.$$
	又 $f(x) = \dsum_{k = 1}^{n} f_k(x) + r_n(x)$, 所以
	$$f'(x) = \dsum_{k = 1}^{n} f'_k(x) + r'_n(x),\quad r'_{n + 1} = r'_n(x) + f_n(x),\quad \text{a.e.}~x \in [a, b].$$
	因为 $r_n(x)$ 单调不减, 所以
	$$\int_{a}^{b}\lim_{n \to \infty} r'_n(x) \di x = \int_{a}^{b} \liminf_{n \to \infty} r'_n(x) \di x \leq \liminf_{n \to \infty} \int_{a}^{b} r'(x) \di x \leq \liminf_{n \to \infty} \(r_n(b) - r_n(a)\).$$
	因此 $f'(x) = \dsum_{k = 1}^\infty f'_k(x)$, a.e.~$x \in [a, b]$.
\end{Proof}

\section{有界变差函数}

\begin{Proposition}~\label{pro:BV}
	\begin{enumerate}
		\item 若 $f \in \BV[a, b]$, 则 $f$ 在 $[a, b]$ 上有界.\label{enu:fBVbound}
		\item 若 $f, g \in \BV[a, b], \a, \beta \in \R$, 则 $\a f + \beta g \in \BV[a, b]$.\label{enu:alphafbetagBV}
		\item $f \in \BV[a, b] \Leftrightarrow \forall c \in (a, b), f \in \BV[a, c] \cap \BV[c, b]$, 同时 $V_a^b(f) = V_a^c(f) + V_c^b(f).$\label{enu:IntervalBV}
		\item 若 $f \in \BV[a, b]$, 则 $f =  \p - \psi$, 其中 $\p(x) = \dfrac{1}{2}\(V_a^x(f) + f(x)\)$, $\psi(x) = \dfrac{1}{2}\(V_a^x(f) - f(x)\)$ 为两个单调不减函数.\label{enu:minus}
	\end{enumerate}
\end{Proposition}

\begin{Proof}
	\eqref{enu:fBVbound} 因为 $f \in \BV[a, b]$, 任意 $x \in [a, b]$, 有
	\begin{align*}
		|f(x)| & = |f(x) - f(a) + f(a)|\\
		& \leq |f(a)| + |f(x) - f(a)| + |f(b) - f(x)|\\
		& = \lb\begin{array}{ll}
			|f(a)| + V(f, a, x, b),	& a < x < b, \\
			|f(a)| + V(f, a, b),	& x = a~\text{或}~x = b,
		\end{array}\right.\\
		&\leq |f(a)| + V_a^b(f) < +\infty.
	\end{align*}
	故 $f$ 在 $[a, b]$ 上是有界的.

	\eqref{enu:alphafbetagBV} 由有界变差函数的定义, 对于任意一组节点 $a = x_0 < x_1 < \cdots < x_n$, 有
	$$V(f, x_0, x_1, \cdots, x_n) \leq V_a^b(f) < + \infty,\quad V(g, x_0, x_1, \cdots, x_n) \leq V_a^b(g) < + \infty,$$
	故
	\begin{align*}
		V(\a f + \beta g, x_0, x_1, \cdots, x_n) &= \dsum_{j = 1}^{n} \lv (\a f + \beta g)(x_j) - (\a f + \beta g)(x_{j - 1}) \rv\\
		&\leq |\a | \dsum_{j = 1}^{n} |f(x_j) - f(x_{j - 1}))| + |\beta | \dsum_{j = 1}^{n} |g(x_j) - g(x_{j - 1}))|\\
		&\leq |\a | V_a^b (f) + |\beta | V_a^b (g) < +\infty.
	\end{align*}
	所以就有
	$$V_a^b (\a f + \beta g) \leq |\a | V_a^b (f) + |\beta | V_a^b (g) < +\infty,$$
	即 $\a f + \beta g \in \BV[a, b]$.

	\eqref{enu:IntervalBV} 必要性. 若 $f \in \BV[a, b]$, 下证 $f \in \BV[a, c]$.

	对于任意节点组 $a = x_0 < x_1 < \cdots < x_m = c$, 都有
	$$V(f, x_0, x_1, \cdots, x_m) = \dsum_{j = 1}^{m} \lv f(x_j) - f(x_{j - 1}) \rv \leq  \dsum_{j = 1}^{m} \lv f(x_j) - f(x_{j - 1}) \rv + |f(b) - f(c)|.$$
	又 $a = x_0 < x_1 < \cdots < x_m = c < b = x_{m + 1}$ 是 $[a, b]$ 的一组节点, 故
	$$V(f, x_0, x_1, \cdots, x_m) \leq V(f, x_0, x_1, \cdots, x_m, x_{m + 1}) \leq V_a^b (f) < +\infty.$$
	因此, $f \in \BV[a, c]$, 类似可证 $f \in \BV[c, b]$.

	充分性. 任取 $[a, b]$ 的一组节点 $a = x_0 < x_1 < \cdots < x_n = b$. 当 $c = x_i$ (对某个 $i$) 时, 有
	$$V(f, x_0, x_1, \cdots, x_n) = \dsum_{j = 1}^{i} |f(x_j) - f(x_{j - 1})| + \dsum_{i + 1}^{n} |f(x_j) - f(x_{j - 1})| \leq V_a^c(f) + V_c^b(f) < +\infty,$$
	所以 $V_a^b(f) \leq V_a^c(f) + V_c^b(f) < +\infty$, 即 $f \in \BV[a, b]$. 当存在 $i$, 使得 $x_{i - 1} < c < x_i$ 时, 有
	\begin{align*}
		&V(f, x_0, x_1, \cdots, x_n)\\
		=& \dsum_{j = 1}^{i - 1} |f(x_j) - f(x_{j - 1})| + |f(x_i) - f(x_{i - 1})| + \dsum_{j = i + 1}^{n} |f(x_j) - f(x_{j - 1})|\\
		\leq& \dsum_{j = 1}^{i - 1} |f(x_j) - f(x_{j - 1})| + |f(c) - f(x_{i - 1})| + |f(x_i) - f(c)| + \dsum_{j = i + 1}^{n} |f(x_j) - f(x_{j - 1})|\\
		=& V(f, x_0, x_1, \cdots, x_{i - 1}, c) + V(f, c, x_i, x_{i + 1}, \cdots, x_n)\\
		\leq& V_a^c(f) + V_c^b(f) < +\infty,
	\end{align*}
	所以 $V_a^b(f) \leq V_a^c(f) + V_c^b(f) < +\infty$, 即 $f \in \BV[a, b]$. 下证 $V_a^b(f) = V_a^c(f) + V_c^b(f)$. 对于任意的 $\ep > 0$, 由变差定义, 存在 $[a, c]$ 的一组节点 $a = x_0 < x_1 < \cdots < x_m = c$, 使 $V(f, x_0, x_1, \cdots, x_m) > V_a^c(f) - \dfrac{\ep}{2}$, 存在 $[c, b]$ 的一组节点 $c = y_0 < y_1 < \cdots < y_k = b$, 使 $V(f, y_0, y_1, \cdots, y_k) > V_c^b(f) - \dfrac{\ep}{2}$. 于是
	\begin{align*}
		V&(f, x_0, x_1, \cdots, x_m = c = y_0, y_1, \cdots, y_k)\\
		&= V(f, x_0, x_1, \cdots, x_m) + V(f, y_0, y_1, \cdots, y_k) > V_a^c(f) + V_c^b(f) - \ep,
	\end{align*}
	故 $V_a^c(f) + V_c^b(f) - \ep < V_a^b(f)$ 对于任意 $\ep > 0$ 成立. 由 $\ep$ 的任意性可得 $V_a^c(f) + V_c^b(f) \leq V_a^b(f)$. 所以 $V_a^c(f) + V_c^b(f) = V_a^b(f)$.

	\eqref{enu:minus} 全变差函数 $V_a^x(f)$, $a \leq b$ 在 $[a, b]$ 上是单调不减的, 由变差定义可得
	\begin{equation}\label{equ:qbc}
		|f(x) - f(a)| \leq V_a^x (f).
	\end{equation}
	下证 $\p$, $\psi$ 单调不减. 当 $x_1, x_2 \in [a, b]$ 时, 不妨设 $x_1 < x_2$,
	\begin{align*}
		\p(x_2) - \p(x_1) & = \dfrac{1}{2} \(V_a^{x_2} (f) + f(x_2)\) - \dfrac{1}{2} \(V_a^{x_1} (f) + f(x_1)\)\\
		&= \dfrac{1}{2} \(V_{x_1}^{x_2} + (f(x_2) - f(x_1))\) \geq 0,\quad(\text{由}~\eqref{equ:qbc}~\text{可得}).
	\end{align*}
\end{Proof}

\begin{Corollary}~
	\begin{enumerate}
		\item 若 $f \in \BV[a, b]$, 则 $f$ 在 $[a, b]$ 上的不连续点至多可数且 $f$ Riemann 可积.
		\item 若 $f \in \BV[a, b]$, 则 $f$ 几乎处处有有限导数, 且 $f' \in L([a, b])$ (由命题 \ref{pro:BV} \eqref{enu:minus}).
	\end{enumerate}
\end{Corollary}

\begin{Example}	%[书上例 2.1]
	若 $f$ 在 $[a, b]$ 上单调, 则 $f \in \BV[a, b]$.
\end{Example}

\begin{Proof}
	不妨设 $f$ 在 $[a, b]$ 上单调不减, 任取 $a = x_0 < \cdots < x_n = b$, 有
	$$V(f, x_0, \cdots, x_n) = \dsum_{j = 1}^{n} \lv f(x_j) - f(x_{j - 1})\rv.$$
	因为 $f$ 单调不减, $f(x_j) - f(x_{j - 1}) \geq 0$, $j = 1, \cdots, n$, 所以
	\begin{align}
		V(f, x_0, \cdots, x_n) = \lv \dsum_{j = 1}^{n} f(x_j) - f(x_{j - 1}) \rv = f(b) - f(a).
	\end{align}
\end{Proof}

\begin{Example}
	$f(x) = x^2 \sin\dfrac{\pi}{x} \in \BV[0, 1]$.
\end{Example}

\begin{Proof}	% [例 2.6]
	任意的点组 $x_0 = 0 < x_1 < \cdots < x_n = 1$, 有
	\begin{align*}
		\dsum_{j = 1}^{n} |f(x_j) - f(x_{j - 1})| &= |f(x_1) - f(0)| + \dsum_{j = 2}^{n} \lv \int_{x_{j - 1}}^{x_j} f'(t) \di t\rv\quad (\text{Newton-Leibniz 公式})\\
		&\leq  |f(x_1)| + \dsum_{j = 2}^{n} \int_{x_{j - 1}}^{x_j} \lv f'(t)\rv \di t\\
		&= |f(x_1)| + \int_{x_1}^{1} \lv f'(t)\rv \di t\\
		&= |f(x_1)| + \int_{x_1}^{1} \lv 2x\sin \dfrac{1}{x} - \cos\dfrac{1}{x}\rv\\
		&\leq 1 + \int_{x_1}^{1} (2 + 1) \di x \leq 4.
	\end{align*}
\end{Proof}

\section{绝对连续函数}

\begin{Example}
	设 $g \in L([a, b])$, 定义 $f(x) = \dint_{[a, x]} g(t) \di t$ 则对任意非空开集 $G \subset [a, b]$, $G = \dbu_k (a_k, b_k)$, 其中 $(a_k, b_k)$ 至多可数且两两不交.
	$$\sum_k \lv f(b_k) - f(a_k) \rv = \sum_k \lv \int_{(a_k, b_k)} g(t) \di t\rv \leq \sum_k \int_{(a_k, b_k)} |g(t)| \di t = \int_{\bigcup_k (a_k, b_k)} \lv g(t)\rv \di t = \int_G \lv g(t)\rv \di t,$$
	即 $\dsum_k \lv f(b_k) - f(a_k) \rv \leq \int_G \lv g(t)\rv \di t$. 所以任意 $\ep > 0$, 存在 $\delta > 0$, 只要 $|G| < \delta$ 就有 $\dsum_k |f(b_k) - f(a_k)| < \ep$.
\end{Example}

\begin{Proposition}[绝对连续函数的性质]~
	\begin{enumerate}
		\item $f \in \AC [a, b] \Rightarrow f \in \BV[a, b] \cap C[a, b]$.\label{enu:AC1}
		\item $f, g \in \AC [a, b] \Rightarrow \a, \beta \in \R, \a f + \beta g \in \AC [a, b]$.\label{enu:AC2}
		\item $f, g \in \AC [a, b] \Rightarrow fg \in \AC [a, b]$.\label{enu:AC3}
		\item $f \in \AC [a, b] \Leftrightarrow \exists g \in L([a, b])$ 使得 $f(x) = \dint_{[a, x]} g(t) \di t + C$.\label{enu:AC4}
	\end{enumerate}
\end{Proposition}

\begin{Proof}
	\eqref{enu:AC1} $f \in C[a, b]$ 显然, 下证 $f \in \BV [a, b]$. 取 $\ep = 1$, 对应定义中的 $\delta_0 > 0$, 使得任意开集 $G \subset [a, b]$, $G(f) < \ep = 1$. 将 $[a, b]$ 分成有限个长度小于 $\delta_0$ 的区间 $[a_{j - 1}, a_j]$, 其中
	$$a = a_1 < a_2 < \cdots < a_k = b,\quad j = 1, \cdots, k,\quad a_j - a_{j - 1} < \delta_0.$$
	对每个 $j$, $1 \leq j \leq k$, 任给 $[a_{j - 1}, a_j]$ 的一组分点 $a_{j - 1} = x_0 < x_1 < \cdots < x_m = a_j$. 记 $G = \dbu_{l = 1}^m(x_{l - 1}, x_l)$, 则 $G$ 为 $[a, b]$ 的一个开子集, 且 $|G| = x_m - x_0 = a_j - a_{j - 1} < \de_0$, 进而 $G(f) = \dsum_{l = 1}^{m} \lv f(x_j) - f(x_{j - 1}) \rv < \ep$. 由有界变差函数定义, 知 $f$ 在 $[a_{j - 1}, a_j]$ 上是有界变差的且 $V_{a_{j - 1}}^{a_j} (f) \leq 1$ 进而 $V_a^b(f) \leq k$, 即 $f \in \BV [a, b]$.

	\eqref{enu:AC2}, \eqref{enu:AC3} 自行证明. \eqref{enu:AC4} 课上还没证.
\end{Proof}

\begin{Theorem}\label{thm:fAC0Const}	% [定理 3.1]
	若 $f \in \AC [a, b]$ 且几乎处处成立 $f'(x) = 0$, 则 $f$ 是 $[a, b]$ 上的常函数.
\end{Theorem}

\begin{Proof}
	由绝对连续定义, 若 $f \in \AC [a, b]$, 则任意 $\ep > 0$,存在 $\de > 0$, 只要非空开集 $G \subset [a, b]$ 满足 $|G| < \de$, 就有 $G(f) < \ep$. 记 $E = \lb x \in (a, b) : f'(x) = 0 \rb$, 则有 $|E| = b - a$. 对任意 $x \in E$, 由导数定义, 有
	$$\lim_{h \to 0+} \dfrac{f(x + h) - f(x)}{h} = 0.$$
	则对上述 $\ep$, 存在 $\eta > 0$, 只要 $h \in (0, \eta)$, 就有
	$$\lv \dfrac{f(x + h) - f(x)}{h} \rv < \ep,\quad [x, x + h] \subset (a, b).$$
	记
	$$\scr{K} = \lb [x, x + h] \subset (a, b) : \lv f(x + h) - f(x) \rv < \ep h\rb,$$
	则 $\scr{K}$ 是 $E$ 的一个 Vitali 覆盖. 由 Vitali 覆盖引理, 存在至多可数个互不相交的闭区间 $B_k \in \scr{K}$, $k \in N \subset \N_+$, 使得 $\lv E \setminus \dbu_k B_k\rv = 0$. 由 $|E| = b - a$ 可得 $\dsum_k \lv B_k \rv \geq b - a$. 对于上述 $\de > 0$, 不妨设 $\de < b - a$, 存在 $m \in \N_+$ 使得 $\dsum_{k = 1}^m |B_k| > b - a - \de$, 记 $G = (a, b) \setminus \dbu_{k = 1}^m B_k$. 则 $G$ 是开集且 $|G| < \de$, $G(f) < \ep$. 记 $B_k = [a_k, b_k]$, $k = 1, 2, \cdots, m$, 则有
	$$|f(b) - f(a)| \leq \sum_{k = 1}^{m} \lv f(b_k) - f(a_k)\rv + G(f) < \ep \sum_{k = 1}^{m} (b_k - a_k) + \ep < \ep (b - a + 1).$$
	由 $\ep > 0$ 的任意性可得 $f(b) = f(a)$.

	把上述过程用在任何闭子区间 $[a, x]$ 上, 就有 $f(x) = f(a)$, 即 $f$ 在 $[a, b]$ 上是常函数.
\end{Proof}

\begin{Theorem}	% [定理 3.2]
	设 $f \in L\([a, b]\)$ 且 $F(x) = \dint_{[a, x]} f(t) \di t$, 则在 $(a, b)$ 上几乎处处成立 $F'(x) = f(x)$.
\end{Theorem}

\begin{Proof}
	若 $f$ 是有界的函数. 设 $|f(x)| \leq B < +\infty$, $x \in [a, b]$. 令 $f(x) = 0$, $x \notin [a, b]$, $x > b$ 时, 有 $F(x) = F(b)$. 令
	$$f_k(x) = \dfrac{F(x + k^{-1}) - F(x)}{k^{-1}},\quad x \in [a, b],$$
	有
	$$\lv f_k(x)\rv = k \lv\dint_{[x, x + k^{-1}]} f(t) \di t\rv \leq B < +\infty,$$
	且 $\dlim_{k \to \infty} f_k(x)$ 几乎处处存在 (\textcolor[rgb]{1.00,0.00,0.00}{????? 为什么存在没搞懂}). 则
	\begin{align*}
		\dint_{[a, x]} F'(t) \di t = & \dint_{[a, x]} \lim_{k \to \infty} f_k(t) \di t\\
		(\text{Lebesgue 控制收敛定理})\quad = & \lim_{k \to \infty} \dint_{[a, x]} f_k(t) \di t\\
		= & \lim_{k \to \infty} k\(\int_{a + k^{-1}}^{x + k^{-1}} F(t) \di t - \int_{a}^{x} F(t) \di t\)\\
		= & \lim_{k \to \infty} k\(\int_{x}^{x + k^{-1}} F(t) \di t - \int_{a}^{a + k^{-1}} F(t) \di t\).
	\end{align*}
	因为 $F \in \AC [a, b]$ 所以 $F \in C[a, b]$, 进而\footnote{应该要用到中值定理.}
	$$\dint_{[a, x]} F'(t) \di t = F(x) - F(a) = F(x).$$
	即 $\dint_{[a, x]} (f(t) - F'(t)) \di t = 0$, $\forall x \in [a, b]$. 由例 \ref{exm:Intaxf0} 知在 $(a, b)$ 上几乎处处成立 $F'(t) = f(t)$.

	对于一般情形. 不妨设几乎处处有 $f \geq 0$, 此时 $F$ 单调不减. 令 $f_n = f\chi_{(f < n)}$, $n \in \N_+$, 且令 $G_n(x) = \dint_{[a, x]} (f - f_n)$. $G_n$ 单调不减且有 $f - f_n = f\(1 - \chi_{f < n}\)$. 此时, $G_n(x) = F(x) - \dint_{[a, x]} f_n(t) \di t$. 由前面所证可得几乎处处有 $F' = G' + f_n \geq f_n$. 在不等式 $F' \geq f_n$ 的两端, 令 $n \to \infty$ 得 $f \leq F'$, 进而
	$$F(x) = \dint_{[a, x]} f(t) \di t \leq \dint_{[a, x]} F'(t) \di t.$$
	由 $F$ 单调不减, 有
	$$\dint_{[a, x]} F'(t) \di t \leq F(x) - F(a) = F(x).$$
	故 $\dint_{[a, x]} F'(t) \di t = F(x)$. 进一步 $\dint_{[a, x]} \(f(t) - F'(t)\) \di t = 0$, 所以几乎处处成立 $f(t) = F'(t)$.
\end{Proof}

\begin{Theorem}[微积分基本定理, Newton-Leibniz 公式]
	设 $f \in \AC[a, b]$, 则 $\dint_{[a, b]} f'(t) \di t = f(b) - f(a)$.
\end{Theorem}

\begin{Proof}
	由
	$$\(f(x) - \int_{[a, x]} f'(t) \di t\)' = f'(x) - f'(x) = 0,\quad \text{a.e.}~x \in [a, b]$$
	及定理 \ref{thm:fAC0Const} 可得 $f(x) - \dint_{[a, x]} f(t) \di t = C$, $C$ 为常数. 令 $x = a$ 可得 $C = f(a)$, 推出结论.
\end{Proof}

\section{Cantor 集与 Cantor 函数}

\begin{Definition}[稀疏集]
	设 $E \subset \R$ 非空, 若任意区间 $I \subset \R$, 都存在子区间 $J \subset I$, 使得 $I \cap E = \varnothing$, 称 $E$ 是稀疏集.
\end{Definition}

\begin{Definition}[奇异函数]
	若函数 $r$ 几乎处处有 $r'(x) = 0$, 则称 $r$ 为奇异函数. 若奇异函数 $r$ 连续, 则称 $r$ 是连续的奇异函数.
\end{Definition}

\subsection{Cantor 集的构造}

记 $I = [0, 1]$. 将 $I$ 三等分成三个区间, 去掉中间的开区间 $I_{11} = \(\dfrac{1}{3}, \dfrac{2}{3}\)$. 将 $I \setminus I_{11}$ 的两个闭区间, 再分别三等分, 分别去掉其中间的开区间 $I_{21} = \(\dfrac{1}{9}, \dfrac{2}{9}\), I_{22} = \(\dfrac{7}{9}, \dfrac{8}{9}\)$. 如此继续, 到第 $n$ 步, 去掉 $2^{n - 1}$ 个长为 $3^{-n}$ 的开区间, 剩下的是长为 $3^{-n}$ 的 $2^n$ 个闭区间. 无限步地进行下去, 去掉的开区间 $I_{nj}$, $j = 1, 2, \cdots, 2^{n - 1}$, $n \in \N_+$, 长为 $3^{-n}$, 且这些开区间两两不交. 记 $G = \dbu_{n = 1}^{\infty} \dbu_{j = 1}^{2^{n-1}} I_{nj}$, 则 $G$ 是开集, 且
	$$|G| = \dsum_{n = 1}^\infty \dbu_{j = 1}^{2^{n - 1}}|I_{nj}| = \dsum_{n = 1}^{\infty} \dfrac{2^{n - 1}}{3^n} = \dfrac{1}{3} \cdot \dfrac{1}{1 - \dfrac{2}{3}} = 1.$$
	记 $P = [0, 1] \setminus G$, $G$ 是开集. 称 $P$ 是 Cantor 集, 有 $|P| = 0$.

\begin{Proposition}[Cantor 集 $P$ 的性质]~
	\begin{enumerate}
		\item $P$ 是稀疏的.\label{pro:CantorChar1}
		\item $P$ 是没有孤立点的闭集 (完全集).\label{pro:CantorChar2}
		\item $P$ 的基数是 $\aleph$ (与 $[0, 1]$ 等势).\label{pro:CantorChar3}
	\end{enumerate}
\end{Proposition}

\begin{Proof}
	\eqref{pro:CantorChar1} 任意区间 $(\a, \beta) \subset \R$. $(\a, \beta) \cap [0, 1] = \varnothing$ 时, 显然有 $(\a, \beta)$ 的一个子区间 $J$, 使得 $J \cap E = \varnothing$. $(\a, \beta) \cap [0, 1] \neq \varnothing$ 时, 有 $(\a, \beta) \cap (0, 1) \neq \varnothing$. 记 $(\a', \beta') = (\a, \beta) \cap (0, 1)$, 则 $(\a', \beta') \cap G \neq \varnothing$, 否则 $(\a', \beta') \subset P$, 这是不可能的, 因为 $|P| = 0$, $\beta' - \a' > 0$. 由 $(\a', \beta') \cap G \neq \varnothing$, 存在 $x_0 \in (\a', \beta') \cap G$, 存在 $\de > 0$ 使得 $(x_0 - \de, x_0 + \de) \subset (\a', \beta') \cap G$, 进而 $(x_0 - \de, x_0 + \de) \cap P \neq \varnothing$.

	\eqref{pro:CantorChar2} 提示: 要证 $x \in P$ 不是孤立点, 即证 $x$ 不是 $P^c = G \cup (-\infty, 0) \cup (0, +\infty)$ 的两个构成区间的端点.

	\eqref{pro:CantorChar3} 任意 $x \in [0, 1]$, $x$ 的三进制表示为
	$$x = x_0 + \sum_{k = 1}^{\infty} \dfrac{x_k}{3^k},\quad x_0 = 0, 1,\quad x_k \in \lb 0, 1, 2 \rb,\quad k = 1, 2, \cdots,$$
	约定不会出现存在 $N$, $k > N$, $x_k = 2$ 的情况. 上述表法唯一, 记为 $x = \prescript{}{3}x_0 . x_1 x_2 \cdots x_n \cdots$. $x$ 也可写成二进制小数
	$$x = y_0 + \sum_{k = 1}^{\infty} \dfrac{y_k}{2^k},\quad y_k \in \lb 0, 1\rb,$$
	约定不会出现存在 $N$, $k > N$, $y_k = 1$ 的情形, 此时记 $x = \prescript{}{2}y_0 . y_1 y_2 \cdots y_n \cdots$.

	再看 Cantor 集的构造过程. 第一步去掉的区间
	$$I_{11} = \(\dfrac{1}{3}, \dfrac{2}{3}\),\quad \forall x \in I_{11},\quad x = \dfrac{1}{3} + \dsum_{j = 2}^\infty \dfrac{x_k}{3^k},$$
	$x_2, \cdots, x_k, \cdots$ 不能全为 $0$, 不能从某项开始全为 $2$, $x = \prescript{}{3}0.1x_2 \cdots x_k \cdots$. 第二步去掉的区间
	$$\(\dfrac{1}{9}, \dfrac{2}{9}\),\quad \(\dfrac{7}{9}, \dfrac{8}{9}\),\quad x \in \(\dfrac{1}{9}, \dfrac{2}{9}\),\quad x = \prescript{}{3}0.01x_3 \cdots,\quad x \in \(\dfrac{7}{9}, \dfrac{8}{9}\),\quad x = \prescript{}{3}0.21x_3 \cdots.$$
	将去掉的区间用三进制表示, 有
	\begin{align*}
		I_{11} &= \prescript{}{3}(0.1, 0.2),\\
		I_{21} &= \prescript{}{3}(0.01, 0.02),\\
		I_{22} &= \prescript{}{3}(0.21, 0.22),\\
		&~\vdots\\
		I_{nj} &= \prescript{}{3}(0.x_1\cdots x_{n - 1} 1, 0.x_1\cdots x_{n - 1} 2),\quad x_1, \cdots, x_{n - 1} \in \lb 0, 2 \rb.
	\end{align*}
	于是任意 $x \in G$ 可表示为
	$$x = \prescript{}{3}0.x_1\cdots x_{m} 1 x_{m + 2} \cdots,\quad x_1, \cdots, x_{m} \in \lb 0, 2\rb,\quad x_k \in \lb 0, 1, 2 \rb,$$
	并且不会出现 $k > N \in \N_+$ 时, $x_k \equiv 2$ 的情形. 则任意 $x \in P$ 可表示为 $x = 1.0$ 或
	$$x = \prescript{}{3}0.x_1 x_2\cdots x_k\cdots,\quad x_j \in \lb 0, 2 \rb,$$
	并且不会出现 $k > N \in \N_+$ 时, $x_k \equiv 2$ 的情形. 任意 $x \in P$, 设
	$$Tx = \prescript{}{2}0.y_1 y_2\cdots y_k \cdots,\quad y_j = \lb\begin{array}{ll}
		0, & x_j = 0, \\
		1, & x_j = 2,
\end{array}\right.\quad T_1 = 1.$$
	易证 $T : P \to [0, 1]$ 是一个一一对应, 进而 $P$ 的势与 $[0, 1]$ 的势相同.
\end{Proof}

\subsection{Cantor 函数}

设
$$\theta(x) = \lb\begin{array}{ll}
	0,\quad x = 0, & 1,\quad x = 1,\\
	\dfrac{2j - 1}{2^n}, & x \in I_{nj},\quad 1 \leq j \leq 2^{n - 1},\quad n \in \N_+,\\
	\dsup_{y < x, y \in G} \theta(y), & x \in P,\quad x \neq 0, 1.
\end{array}\right.$$
有如下性质.
\begin{enumerate}
	\item $\theta \in C\([0, 1]\)$.
	\item $\theta$ 单调不减.
	\item $\theta(0) = 1$, $\theta(1) = 1$ 且几乎处处有 $\theta'(x) = 0$.
	\item $\dint_{[0, 1]} \theta'(x) \di x = 0 < \theta(1) - \theta(0) = 1$.
	\item $\theta$ 是一个连续的奇异函数.
\end{enumerate}

\begin{Theorem}
	设 $f$ 在 $[a, b]$ 上为有界变差函数, 则 $\p(x) = f(x) - \dint_{[a, x]} f'$ 是一个奇异函数. 称
	$$f(x) = \dint_{[a, x]} f'(x) + \p(x)$$
	为 $f$ 的绝对连续奇异函数分解. $f \in \AC [a, b]$ 时, $\p(x) \equiv$ 常数.
\end{Theorem}

\section{一些例子}

\begin{Example}
	设 $f \in \BV[a, b]$. 则 $f$ 在 $x$ 点连续, 当且仅当 $V_a^x(f)$ 在 $x$ 点连续.
\end{Example}

\begin{Proof}
	充分性. 设 $x + \D x$, $x \in [a, b]$. $\D x > 0$ 时,
	$$\lv f(x + \D x) - f(x)\rv \leq V_x^{x + \D x}(f) = V_a^{x + \D x}(f) - V_a^x(f).$$
	因为 $V_a^x(f)$ 在 $x$ 点连续, 所以 $\dlim_{\D x \to 0+} V_a^{x + \D x}(f) = V_a^x$, 因此 $\dlim_{\D x \to 0+} f(x + \D x) = f(x)$. 类似地, $\D x < 0$ 时, 由
	$$\lv f(x) - f(x + \D x)\rv \leq V_{x + \D x}^x(f) = V_a^x(f) - V_a^{x + \D x}(f)$$
	及 $V_a^x(f)$ 在 $x$ 点的连续性知 $\dlim_{x \to 0-} f(x + \D x) = f(x)$. 综上所述, $f$ 在 $x$ 点连续.

	必要性. 设 $f$ 在 $x$ 连续, 下证 $V_a^x(f)$ 在 $x$ 连续. 由 $f \in \BV[a, b]$, 则对于任意的 $\ep > 0$, 存在一个分点组 $a = x_0 < \cdots < x_n = b,$ 使得
	$$V_a^b (f) < V(f, x_0, x_1, \cdots, c_n) + \dfrac{\ep}{2}.$$
	不妨设 $x \in (a, b)$, 令
	$$s = \max\lb x_j : x_j < x \rb,\quad t = \min\lb x_j : x_j > x \rb,$$
	有
	\begin{align*}
		V_a^b(f) &= V_a^s(f) + V_s^t(f) + V_t^b(f) < V(f, x_0, \cdots, x_n) + \dfrac{\ep}{2}\\
		&\leq V(f, x_0, x_1, \cdots, s) + V(f, t, \cdots, x_n) + \dfrac{\ep}{2} + |f(x) - f(s)| + |f(t) - f(x)|\\
		&\leq V_a^s(f) + V_t^b(f) + |f(x) - f(s)| + |f(t) - f(x)| + \dfrac{\ep}{2},
	\end{align*}
	故
	$$V_s^t(f) \leq |f(x) - f(s)| + |f(t) - f(x)| + \dfrac{\ep}{2}.$$
	由 $f$ 的连续性, 对于上述的 $\ep > 0$, 存在 $\de > 0$, 只要 $y \in [a, b]$ 且 $|y - x| < \de$, 就有 $|f(y) - f(x)| < \dfrac{\ep}{4}$. 此时不妨认为 $x_0, x_1, \cdots, x_n$ 满足 $|x_{j + 1} - x_j| < \de$, $j = 0, 1, 2, \cdots, n - 1$. 此时 $|t - x| < \de$, $|s - x| < \de$, 必有 $|f(t) - f(x)| < \dfrac{\ep}{4}$, $|f(x) - f(s)| < \dfrac{\ep}{4}$, 进而 $V_s^t(f) < \ep$. 故 $|\D x| < \de$ 时,
	\begin{align*}
		\lv V_a^{x + \D x}(f) - V_a^x(f)\rv = \lb\begin{array}{ll}
			V_x^{x + \D x}, & \D x > 0, \\
			V_{x + \D x}^x, & \D x < 0,
		\end{array}\rd < \ep.
	\end{align*}
\end{Proof}

\begin{Example}
	$f \in \AC[a, b] \Leftrightarrow V_a^x(f) \in \AC[a, b]$.
\end{Example}

\begin{Proof}
	充分性. 由 $V_a^x(f) \in \AC[a, b]$, 按定义, 对于任意的 $\ep > 0$, 存在 $\de > 0$, 只要 $[a, b]$ 的一组至多可数个互不相交的开区间 $\lb \(a_v, b_v\) \rb$ 满足 $\dsum_v |b_v - a_v| < \de$, 就有
	$$\dsum_v \lv V_a^{b_v}(f) - V_a^{a_v}(f)\rv < \ep,$$
	即此时 $\dsum_{v} V_{a_v}^{b_v}(f) < \ep$. 因此
	$$\sum_v\lv f(b_v) - f(a_v)\rv \leq \sum_v V_{a_v}^{b_v} < \ep.$$
	所以 $f \in \AC[a, b]$.

	必要性. $f \in \AC[a, b]$, 则
	$$f(x) = f(a) + \int_{[a, x]} f'(t) \di t,\quad x \in [a, b].$$
	由此, 对 $[a, b]$ 的任何一个子区间 $[\a, \beta] \subset [a, b]$ 都有 $V_\a^\beta(f) \leq \dint_{[\a, \beta]} |f'(t)| \di t$. 事实上, 对 $[\a, \beta]$ 的任何一组分点 $\a = t_0 < \cdots < t_m = \beta$, 都有
	$$\sum_{v = 1}^m \lv f(t_v) - f(t_{v - 1})\rv = \sum_{v = 1}^{m} \lv \int_{[t_{v - 1}, t_v]} f'(t) \di t \rv \leq \sum_{v = 1}^{m} \dint_{[t_{v - 1}, t_v]} |f'(t)| \di t = \int_{[\a, \beta]} |f'(t)| \di t.$$
	由有界变差函数的定义可得 $V_\a^\beta (f) \leq \dint_{[\a, \beta]} |f'(t)| \di t$. 再由积分的绝对连续性, $f' \in L([a, b])$, 对于任意的 $\ep > 0$, 存在 $\de > 0$, 只要可测集 $A \subset [a, b]$, $|A| < \de$, 就有 $\dint_A |f'| < \ep$. 若 $A = \dbu_v (\a_v, \beta_v)$, 其中 $\lb \(\a_v, \beta_v\)\rb$ 是 $[a, b]$ 的一族互不相交至多可数个开区间. 只要 $\dsum_v (b_v - a_v) < \de$ 就有
	\begin{align*}
		\sum_v & \lv V_a^{\beta_v} (f) - V_a^{\a_v}(f)\rv = \sum_v V_{\a_v}^{\beta_v} (f) \leq \sum_v \int_{[\a_v, \beta_v]} |f'(t)| \di t = \int_{\bigcup_v [\a_v, \beta_v]} |f'(t)| \di t < \ep.
	\end{align*}
	因此, $V_a^x(f)$ 是 $[a, b]$ 上的绝对连续函数.
\end{Proof}

\begin{Remark}
	若 $f \in \AC[a, b]$, 则
	$$V_a^x(f) = \int_{[a, x]} |f'(t)| \di t,\quad a \leq x \leq b,$$
	即几乎处处成立 $\dfrac{\di}{\di x}V_a^x(f) = |f'(x)|$, 这是因为
	\begin{align*}
		\dfrac{1}{\D x} V_x^{x + \D x}(f) = \dfrac{1}{\D x}\int_{[x, x + \D x]} |f'(t)| \di t.
	\end{align*}
\end{Remark}

\begin{Example}
	设 $\a$, $\beta > 0$ 且
	$$f_{\a, \beta}(x) = \lb\begin{array}{ll}
		x^\a \sin\dfrac{1}{x^\beta}, & 0 < x < +\infty, \\
		0, & x = 0.
	\end{array}\rd$$
	问, $\a$, $\beta$ 满足什么条件时 $f_{\a, \beta} \in \BV[0, 1]$, 满足什么条件时 $f_{\a, \beta} \in \AC[0, 1]$.
\end{Example}

\begin{Solve}(\textcolor[rgb]{1.00,0.00,0.00}{?????这题好像还是算错了.})
	由于 $f_{\a, \beta} \in \AC[0, 1]$ 的必要条件是 $f_{\a, \beta} \in L([0, 1])$, 故首先求出 $f'_{\a, \beta}$.
	$$f'_{\a, \beta}(x) = \lb \begin{array}{ll}
		\a x^{\a - 1}\sin\dfrac{1}{x^\beta} - \beta x^{\a - \beta - 1}\cos \dfrac{1}{x^\beta}, & x > 0, \\
		0, & x = 0,~\a > 1,\\
		\text{不存在}, & x = 0,~\a \leq 1.
	\end{array} \rd$$

(1) $\lv\a x^{\a - 1}\sin\dfrac{1}{x^\beta}\rv \leq \a x^{\a - 1}, 0 < x \leq 1$. $\a \geq 1$ 时, $\a x^{\a - 1}$ 在 $[0, 1]$ 是广义绝对 Riemann 可积的, $\a x^{\a - 1}\sin \dfrac{1}{x^\beta}$ 在 $(0, 1]$ 是 Riemann 可积的, 故这项是 Lebesgue 可积的.

(2)
\begin{align*}
	\int_{0}^{1} \lv x^{\frac{\a - \beta - 1}{\beta}} \cos \dfrac{1}{x^\beta} \rv \di x & = \dfrac{1}{\beta} \int_1^{+\infty} t^{\beta + 1 - \a} |\cos t| t^{-\frac{1}{\beta} - 1} \di t = \dfrac{1}{\beta} \int_{1}^{+\infty} t^{- \frac{\a}{\beta}} |\cos t| \di t
\end{align*}
	收敛, 当且仅当 $\dfrac{\a}{\beta} > 1$.

	$f'_{\a, \beta} \in L([0, 1]) \Leftrightarrow \a > \beta$. 故 $\a \leq \beta$ 时, $f_{\a, \beta} \notin \BV[0, 1]$.

	当 $\a > \beta$ 时, 可得
	$$f_{\a, \beta}(x) = \int_{[0, x]} f'_{\a, \beta} (t) \di t + f_{\a, \beta}(0), \quad 0 \leq x \leq 1,$$
	所以 $f_{\a, \beta} \in \AC[0, 1] \subset \BV[0, 1]$.

%-------------------

%	$$\int_{[0, 1]} x^{\a - \beta - 1}\cos \dfrac{1}{x^\beta} \di x = \int_{1}^{+\infty} t^{1 + \frac{1}{\beta} - \frac{\a}{\beta}} \cos t \di t = \int_{1}^{+\infty} \dfrac{\cos t}{t^{-1 - \frac{1}{\beta} + \frac{\a}{\beta}}} \di t,$$
%	收敛且绝对收敛当且仅当 $-1 - \frac{1}{\beta} + \frac{\a}{\beta} > 1$, 即 $\a > 2\beta + 1$.

	下证 $\a > \beta$ 时, $f_{\a, \beta} \in \AC[0, 1]$. 首先 $f_{\a, \beta} \in C([0, 1])$, 下证 $f_{\a, \beta} \in \AC[0, 1]$. 只须证 $f_{\a, \beta}(x) = f_{\a, \beta}(0) + \dint_{[a, x]} f'_{\a, \beta}(t) \di t, x > 0, f(0) = 0$.

	注意到对于任意的 $\ep \in (0, x)$, $f_{\a, \beta}$ 在 $[a, x]$ 有连续导数, 则有分析中 Newton-Leibniz 公式,
	$$f_{\a, \beta} (x) - f_{\a, \beta}(\ep) = \int_{[\ep, x]} f'_{\a, \beta}(t) \di t.$$
	由于 $\a > \beta$ 时, $f'_{\a, \beta} \in L([0, 1])$ 及 $f \in C([0, 1])$, 故 $\dlim_{\ep \to 0+} f(\ep) = 0$ 及
	$$\lim_{\ep \to 0+} \int_{[\ep, x]} f'_{\a, \beta}(t) \di t = \int_{[0, x]} f'_{\a, \beta}(t) \di t~\text{(积分绝对连续性)},$$
	进一步
	$$f_{\a, \beta}(x) = \dint_{[0, x]} f'_{\a, \beta}(t) \di t,\quad \forall x \in [0, 1],$$
	所以 $f_{\a, \beta} \in \AC[0, 1]$.
\end{Solve}

\begin{Example}\label{exm:Intaxf0}
	若 $f \in L\([a, b]\)$ 且对于任意的 $x \in [a, b]$, 都有 $\dint_a^x f(t) \di t = 0$, 则几乎处处成立 $f(x) = 0$.
\end{Example}

\begin{Proof}
	对于任意的 $\a$, $\beta \in [a, b]$, $\a < \beta$, 有
	$$\int_{(\a, \beta)} f = \int_{a}^\beta f - \int_a^\a f = 0.$$
	若 $G \subset [a, b]$ 是非空开集, 由开集结构性质 $G = \dbu_{k \in J} (\a_k, \beta_k)$, 其中 $(\a_k, \beta_k)$ 为至多可数个开区间, 有
	$$\int_G f = \int_{\bigcup_{k \in J} (\a_k, \beta_k)} f = \sum_{k \in J} \int_{(\a_k, \beta_k)} f = 0.$$
	设 $E \subset [a, b]$ 为可测集, $E \setminus \lb a, b\rb$ 可测. 存在一列开集列 $\lb G_k \rb$, 使得
	$$E \setminus \lb a, b \rb \subset G_k \subset (a, b),\quad \lv\dba_{k = 1}^\infty G_k \setminus \(E \setminus \lb a, b\rb\)\rv = 0,$$
	于是
	$$\int_E f = \int_{E \setminus \lb a, b\rb} f = \int_{\bigcap_{k = 1}^\infty G_k} f - \int_{\bigcap_{k = 1}^\infty G_k \setminus \(E \setminus \lb a, b\rb\)} f = \int_{\bigcap_{k = 1}^\infty G_k} f.$$
	又因为
	$$\dlim_{N \to \infty} f\chi_{\bigcap_{k = 1}^N G_k} = f\chi_{\bigcap_{k = 1}^\infty G_k},\quad \lv f\chi_{\bigcap_{k = 1}^N G_k} \rv \leq |f| \in L\([a, b]\),$$
	所以由 Lebesgue 控制收敛定理可得
	$$\int_{\bigcap_{k = 1}^\infty G_k} f = \int_{[a, b]} f\chi_{\bigcap_{k = 1}^\infty G_k} = \int_{[a, b]} \lim_{N \to \infty} f\chi_{\bigcap_{k = 1}^N G_k} = \lim_{N \to \infty} \int_{[a, b]} f\chi_{\bigcap_{k = 1}^N G_k} = \lim_{N \to \infty} \int_{\bigcap_{k = 1}^N G_k} f.$$
	因 $\dba_{k = 1}^N G_k$, $N \in \N_+$ 是开集, 所以 $\dint_{\bigcap_{k = 1}^N G_k} = 0$, 进而 $\dint_{\bigcap_{k = 1}^\infty G_k} f = 0$, 所以 $\dint_E f = 0$. 取
	$$E_1 = \lb x \in [a, b] : f(x) > 0 \rb,\quad E_2 = \lb x \in [a, b] : f(x) < 0 \rb,$$
	由 $0 = \dint_{E_1} f$ 可得 $|E_1| = 0$. 事实上, 令
	$$E_k = \lb x \in [a, b] : f(x) > \dfrac{1}{k} \rb,\quad k = 3, 4, \cdots,$$
	有
	$$0 = \int_{E_k} f \geq \frac{1}{k}\lv E_k \rv,\quad E_1 = \dbu_{k = 3}^\infty E_k,$$
	所以 $\lv E_1\rv = 0$. 进而几乎处处成立 $f(x) \leq 0$, 同理几乎处处成立 $f(x) \geq 0$. 所以几乎处处成立 $f(x) = 0$.
\end{Proof}

\begin{Example}
	设 $E \subset \R$ 可测且测度有限. 求 $\dlim_{n \to \infty} \dint_E |\sin nx| \di x$.
\end{Example}

\begin{Solve}
	(1) $E = (\a, \beta)$, $-\infty < \a < \beta < +\infty$ 时, 有
	$$\dint_E |\sin nx| \di x = \dfrac{1}{n} \int_{n\a}^{n\beta} |\sin t| \di t = \dfrac{1}{n} \int_{n\a}^{[\frac{n\a}{\pi}]\pi + \pi}|\sin t| \di t + \dfrac{1}{n} \sum_{k = [\frac{n\a}{\pi}] + 1}^{[\frac{n\beta}{\pi} - 1]} \int_{k\pi}^{(k + 1)\pi} |\sin t| \di t + \dfrac{1}{n}\int_{[\frac{n\beta}{\pi}]\pi}^{n\beta} |\sin t| \di t.$$
	又因为 $n \to \infty$ 时,
	\begin{align*}
		\lv \dfrac{1}{n} \int_{n\a}^{[\frac{n\a}{\pi}]\pi + \pi}|\sin t| \di t \rv &\leq \dfrac{2}{n} \to 0,\\
		\lv \dfrac{1}{n}\int_{[\frac{n\beta}{\pi}]\pi}^{n\beta} |\sin t| \di t \rv & \leq \dfrac{2}{n} \to 0,\\
		\dfrac{1}{n} \sum_{k = [\frac{n\a}{\pi}] + 1}^{[\frac{n\beta}{\pi} - 1]} \int_{k\pi}^{(k + 1)\pi} |\sin t| \di t &= \dfrac{2}{n} \( \l[ \dfrac{n\beta}{\pi} \r] - 1 - \l[\dfrac{n \a}{\pi}\r]\) \to \dfrac{2(\beta - \a)}{\pi},
	\end{align*}
	所以 $\dlim_{n \to \infty} \dint_\a^\beta |\sin nx| \di x = \dfrac{2(\beta - \a)}{\pi}$.

	(2) 设 $G = \dbu_{k = 1}^m (\a_k, \beta_k)$, $|G| < \infty$, $(\a_k, \beta_k)$ 两两不交, 有
	$$\lim_{n \to \infty} \int_G |\sin nx| \di x = \lim_{n \to \infty} \sum_{k = 1}^{m} \int_{(\a_k, \beta_k)} |\sin nx| \di x = \dfrac{2}{\pi} \sum_{k = 1}^{m} \(\beta_k - \a_k\) = \dfrac{2|G|}{\pi}.$$

	(3) $G = \dbu_{k = 1}^\infty (\a_k, \beta_k)$, $|G| < \infty$, $(\a_k, \beta_k)$ 两两不交时, 对于任意的 $\ep > 0$, 存在 $N \in \N_+$, $k > N$ 时, $\dsum_{j = k + 1}^\infty (\beta_j - \a_j) < \ep$, 令 $G_{N + 1} = \dbu_{k = 1}^{N + 1} (\a_k, \beta_k)$, 有
	\begin{align*}
		\dint_G |\sin nx| \di x &= \dint_{G_{N + 1}} |\sin nx| \di x + \int_{G \setminus G_{N + 1}} |\sin nx| \di x,\\
		\int_{G \setminus G_{N + 1}} |\sin nx| \di x &\leq |G \setminus G_{N + 1}| < \ep,\\
		\dint_{G_{N + 1}} |\sin nx| \di x &\leq \int_G |\sin nx| \di x \leq \dint_{G_{N + 1}} |\sin nx| \di x + \ep.
	\end{align*}
	对于任意的 $n \in \N_+$, 有
	\begin{align*}
		\dfrac{2|G_{N + 1}|}{\pi} = \lim_{n \to \infty} \int_{G_{N + 1}} |\sin nx| \di x \leq \liminf_{n \to \infty} \int_G |\sin nx| \di x \leq \limsup_{n \to \infty} \int_G |\sin nx| \di x \leq \dfrac{2|G_{N + 1}|}{\pi} + \ep.
	\end{align*}
	令 $N \to \infty$, 有
	$$\dfrac{2|G|}{\pi} \leq \liminf_{n \to \infty} \int_G |\sin nx| \di x \leq \limsup_{n \to \infty} \int_G |\sin nx| \di x \leq \dfrac{2|G|}{\pi} + \ep.$$
	由 $\ep$ 的任意性, $\dlim_{n \to \infty} \dint_G |\sin nx| \di x$ 存在且等于 $\dfrac{2|G|}{\pi}$.

	(4) 设 $E \subset \R$ 可测且 $|E| < \infty$. 存在一列开集 $\lb G_k \rb$ 使得
	$$G_k \supset E,\quad \lv \dba_{k = 1}^\infty G_k \setminus E \rv = 0,\quad |G_k| < \infty,\quad k \in \N_+,$$
	有
	$$\dint_E|\sin nx|\di x = \dint_{\bigcap_{k = 1}^N G_k} |\sin nx| \di x - \dint_{\bigcap_{k = 1}^N G_k \setminus E} |\sin nx| \di x.$$
	由于 $\lb \dba_{k = 1}^N G_k \rb_{N = 1}^\infty$ 是单减集列且 $|G_1| < \infty$, 则
	$$\lim_{N \to \infty} \lv \dba_{k = 1}^N G_k \rv = \lv \dba_{k = 1}^\infty G_k \rv = |E|,$$
	故
	$$\lv \dba_{k = 1}^N G_k \setminus E \rv \to 0,\quad N \to \infty.$$
	又
	$$\int_{\bigcap_{k = 1}^N G_k \setminus E} |\sin nx| \di x \leq \lv \dba_{k = 1}^N G_k \setminus E \rv,$$
	对于任意的 $\ep > 0$, 存在 $N_0$ 使得 $N > N_0$ 时有 $\lv \dba_{k = 1}^N G_k \setminus E \rv < \ep$. 所以对每个 $N > N_0$, 有
	$$\dint_{\bigcap_{k = 1}^N G_k} |\sin nx| \di x - \lv \dba_{k = 1}^N G_k \setminus E \rv \leq \int_E |\sin nx| \di x \leq \dint_{\bigcap_{k = 1}^N G_k} |\sin nx| \di x,$$
	进而
	$$\dfrac{2}{\pi}\lv\dba_{k = 1}^N G_k \rv - \ep \leq \liminf_{n \to \infty} \int_E |\sin nx| \di x \leq \limsup_{n \to \infty} \int_E |\sin nx| \di x \leq \dfrac{2}{\pi}\lv\dba_{k = 1}^N G_k \rv.$$
	令 $N \to \infty$, 有
	$$\dfrac{2|E|}{\pi} - \ep \leq \liminf_{n \to \infty} \int_E |\sin nx| \di x \leq \limsup_{n \to \infty} \int_E |\sin nx| \di x \leq \dfrac{2|E|}{\pi}.$$
	由 $\ep$ 的任意性可得 $\dlim_{n \to \infty} \dint_E |\sin nx| \di x$ 存在且等于 $\dfrac{2|E|}{\pi}$.
\end{Solve}

\begin{Example}
	设 $M > 0$. $|f(x) - f(y)| \leq M|x - y|$, $\forall x, y \in [a, b]$ $\Leftrightarrow$ $f \in \AC[a, b]$ 且 $|f'(x)| \leq M$,~a.e.~$x \in [a, b]$.
\end{Example}

\begin{Proof}
	只给出提示. 设 $f$ 在 $x_0 \in (a, b)$ 处有导数, 有 $\lv\dfrac{f(x_0 + \D x) - f(x_0)}{\D x}\rv \leq M$, 进而 $|f'(x_0)| \leq M$. 反之, 若 $|f'| \leq M$, 则有
	\begin{align*}
		f(x) = f(a) + \int_a^x f',\quad |f(x) - f(y)| = \lv \int_x^y f' \rv \leq M|x - y|.
	\end{align*}
\end{Proof}

\end{document}
